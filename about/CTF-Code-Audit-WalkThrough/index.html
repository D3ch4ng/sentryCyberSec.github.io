<!DOCTYPE html>
<html>

    <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="本站由哨兵安全实验室支持创办">

<link rel="shortcut icon" href="/assets/img/favicon.png">
<link type="application/atom+xml" rel="alternate" href="/feed.xml" title="© 哨兵" />



<!-- Open Graph metadata -->
<meta property="og:type" content="website" />
<meta property="og:title" content="Ctf Code Audit Walkthrough | © 哨兵" />
<meta property="og:description" content="本站由哨兵安全实验室支持创办" />
<meta property="og:image" content="https://sentrylab.cn/assets/img/logo-share.png" /> <!-- WeChat requires that thumbnail image is larger than 300x300 -->
<meta property="og:url" content="https://sentrylab.cn/about/CTF-Code-Audit-WalkThrough/" />
<title> CTF - 代码审计向 | © 哨兵 | Sentry CyberSecurity</title>

<link rel="stylesheet" type="text/css" href="/assets/css/pace-minimal.css">
<script src="/assets/js/pace.min.js"></script>

<!--
script to install Ionic Framework @bin4xin. <https://ionic.io/ionicons/usage>
-->
<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

<!-- Bootstrap core CSS -->
<link href="/assets/css/bootstrap.css" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="/assets/css/style.css" rel="stylesheet">
<link href="/assets/css/font-awesome.min.css" rel="stylesheet">
<link href="/assets/css/font-awesome-v4-shims.min.css" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/404-style.css">


<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>
<script src="/assets/js/jquery.sticky/1.0.4/jquery.sticky.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>


<!--mathjax-config scripts.-->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$$','$$']]
      }
    });
</script>
<script src="/assets/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!--mathjax-config scripts stop.-->



</head>


    <body>

        <!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><!--
   --><picture>
  <source srcset="/assets/img/logo-small-dark.png 1x, /assets/img/logo-small-dark@2x.png 2x, /assets/img/logo-small-dark@3x.png 3x, /assets/img/logo-small-dark@4x.png 4x" media="(prefers-color-scheme: dark)" />
  
  <img src="/assets/img/logo-small.jpg" srcset="/assets/img/logo-small.png 1x, /assets/img/logo-small@2x.png 2x, /assets/img/logo-small@3x.png 3x, /assets/img/logo-small@4x.png 4x" />
  </picture> © 哨兵</a>
    </div>
    <div class="navbar-collapse collapse navbar-right">

      <ul class="nav navbar-nav">
        
        <li ><a href="/">HOME</a></li>
        <li ><a href="/blog/">BLOG</a></li>
<!--under construction <li ><a href="/categories/">CATEGORIES</a></li> -->
        <li ><a href="/daily/">DAILY</a></li>
        <li class="active"><a href="/about/">ABOUT</a></li>
        <li ><a href="/feed.xml">RSS</a></li>
        <li ><a href="/usage/">QUICK START</a></li>
        
      </ul>
    </div><!--/.nav-collapse -->

  </div>
</div>

            <style>
.navbar-hide{
	display: none;
}
</style>



<script>
	window.Researchname = "CTF - 代码审计向";
</script>


<div id="help-page">
	<div class="container">
	  <div class="row">
		  <div class="col-sm-3 hidden-xs">
				<ul class="nav nav-pills nav-stacked" id="help-nav">
					
					<li id="toc-ATT&CK - 基于 scylla 的访问代理池"><a href="/about/Thousand-people-Thousand-faces-Red-team-penetration-agent-pool-based-on-scylla/"><code-index-css>ATT&CK - 基于 scylla 的访问代理池</code-index-css></a></li>
					
					<li id="toc-Apache Log4J RCE复现历程"><a href="/about/Apache-Log4j-RCE-WalkThrough/"><code-index-css>Apache Log4J RCE复现历程</code-index-css></a></li>
					
					<li id="toc-BurpSuite验证码插件实验"><a href="/about/CAPTCHA-BYPASS-WALKTHROUGH/"><code-index-css>BurpSuite验证码插件实验</code-index-css></a></li>
					
					<li class="active" id="toc-CTF - 代码审计向"><a href="/about/CTF-Code-Audit-WalkThrough/"><code-index-css>CTF - 代码审计向</code-index-css></a></li>
					
					<li id="toc-CTF - 密码学与杂项"><a href="/about/CTF-Crypto-and-Misc-etc-WalkThrough/"><code-index-css>CTF - 密码学与杂项</code-index-css></a></li>
					
					<li id="toc-Dynamic-analysis-of-java-framework-code"><a href="/about/Dynamic-analysis-of-java-framework-code/"><code-index-css>Dynamic-analysis-of-java-framework-code</code-index-css></a></li>
					
					<li id="toc-Hikvision-ConfigurationFiles-decrypter"><a href="/about/Hikvision-ConfigurationFiles-decrypter/"><code-index-css>Hikvision-ConfigurationFiles-decrypter</code-index-css></a></li>
					
					<li id="toc-JRMP-Gadget"><a href="/about/JRMP-Gadget/"><code-index-css>JRMP-Gadget</code-index-css></a></li>
					
					<li id="toc-Mod-Waf-Bypass-Walkthrough"><a href="/about/Mod-Waf-Bypass-Walkthrough/"><code-index-css>Mod-Waf-Bypass-Walkthrough</code-index-css></a></li>
					
					<li id="toc-ModSec & CloudFlare WAF Initial Research"><a href="/about/WAF-developed-by-Grayscale-forwarding/"><code-index-css>ModSec & CloudFlare WAF Initial Research</code-index-css></a></li>
					
					<li id="toc-Router-BinFile-Analysis"><a href="/about/Router-BinFile-Analysis/"><code-index-css>Router-BinFile-Analysis</code-index-css></a></li>
					
					<li id="toc-SQL注入原理分析"><a href="/about/ALL-SQL-INJECTION-ANALYSIS/"><code-index-css>SQL注入原理分析</code-index-css></a></li>
					
					<li id="toc-ShiroDeser"><a href="/about/ShiroDeser/"><code-index-css>ShiroDeser</code-index-css></a></li>
					
					<li id="toc-SpringBoot-Memory-files-heapdump-Analysis"><a href="/about/SpringBoot-Memory-files-heapdump-Analysis/"><code-index-css>SpringBoot-Memory-files-heapdump-Analysis</code-index-css></a></li>
					
					<li id="toc-Struts2Deser"><a href="/about/Struts2Deser/"><code-index-css>Struts2Deser</code-index-css></a></li>
					
					<li id="toc-javaDeser"><a href="/about/javaDeser/"><code-index-css>javaDeser</code-index-css></a></li>
					
					<li id="toc-polkit-CVE-2021-3560"><a href="/about/polkit-CVE-2021-3560/"><code-index-css>polkit-CVE-2021-3560</code-index-css></a></li>
					
					<li id="toc-基于内存的Shiro框架Webshell攻击研究"><a href="/about/Research-on-Webshell-Attack-of-Shiro-Framework-Based-on-Memory/"><code-index-css>基于内存的Shiro框架Webshell攻击研究</code-index-css></a></li>
					
					<li id="toc-安全与开发之：Maven构建排错"><a href="/about/ALL-mvn-build-errors/"><code-index-css>安全与开发之：Maven构建排错</code-index-css></a></li>
					
					<li id="toc-浪潮ClusterEngineV4.0代码审计历程"><a href="/about/inspur-Cluster-Engine-V4.0-code-aduit-walkthrough/"><code-index-css>浪潮ClusterEngineV4.0代码审计历程</code-index-css></a></li>
					
					<li id="toc-通达OA利用代码分析"><a href="/about/ToDa-OA-VulnPoc-by-java-analysis/"><code-index-css>通达OA利用代码分析</code-index-css></a></li>
					
				</ul>
				<!--see /assets/js/sentryabout.js to top article index（书签）-->
				
				<div id="sticky-wrapper" class="sticky-wrapper" style="height: 200px;">
					<li class="nav nav-pills nav-stacked" id="help-nav">
						<code-index-css>
							<details open class="article-index" style="overflow: visible;">
								<summary class="point">文章目录&nbsp &nbsp</summary>
								<div class="hline"></div>
								<div class="spacing"></div>
								<ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#零web">零：WEB</a>
<ul>
<li class="toc-entry toc-h4"><a href="#-0x01-任意文件读取绕过"># 0x01 任意文件读取绕过</a></li>
<li class="toc-entry toc-h4"><a href="#-0x02-nannannannan-batman奇妙的js"># 0x02 NaNNaNNaNNaN-Batman：奇妙的js</a></li>
<li class="toc-entry toc-h4"><a href="#-0x03-php伪协议"># 0x03 php伪协议</a></li>
<li class="toc-entry toc-h4"><a href="#-0x03-卖瓜"># 0x03 卖瓜</a></li>
</ul>
</li>
</ul>
							</details>
						</code-index-css>
					</li>
				</div>
				 





			</div><!-- sidenave -->
			<div class="col-sm-9">
				<div class="visible-xs">
					<form class="form-inline">
						<div class="form-group">
							<label>选择: </label>
							<select class="form-control" id="help-select">
								
								<option data-help-url="/about/Thousand-people-Thousand-faces-Red-team-penetration-agent-pool-based-on-scylla/" id="toc-ATT&CK - 基于 scylla 的访问代理池">ATT&CK - 基于 scylla 的访问代理池</option>
								
								<option data-help-url="/about/Apache-Log4j-RCE-WalkThrough/" id="toc-Apache Log4J RCE复现历程">Apache Log4J RCE复现历程</option>
								
								<option data-help-url="/about/CAPTCHA-BYPASS-WALKTHROUGH/" id="toc-BurpSuite验证码插件实验">BurpSuite验证码插件实验</option>
								
								<option data-help-url="/about/CTF-Code-Audit-WalkThrough/" selected id="toc-CTF - 代码审计向">CTF - 代码审计向</option>
								
								<option data-help-url="/about/CTF-Crypto-and-Misc-etc-WalkThrough/" id="toc-CTF - 密码学与杂项">CTF - 密码学与杂项</option>
								
								<option data-help-url="/about/Dynamic-analysis-of-java-framework-code/" id="toc-Dynamic-analysis-of-java-framework-code">Dynamic-analysis-of-java-framework-code</option>
								
								<option data-help-url="/about/Hikvision-ConfigurationFiles-decrypter/" id="toc-Hikvision-ConfigurationFiles-decrypter">Hikvision-ConfigurationFiles-decrypter</option>
								
								<option data-help-url="/about/JRMP-Gadget/" id="toc-JRMP-Gadget">JRMP-Gadget</option>
								
								<option data-help-url="/about/Mod-Waf-Bypass-Walkthrough/" id="toc-Mod-Waf-Bypass-Walkthrough">Mod-Waf-Bypass-Walkthrough</option>
								
								<option data-help-url="/about/WAF-developed-by-Grayscale-forwarding/" id="toc-ModSec & CloudFlare WAF Initial Research">ModSec & CloudFlare WAF Initial Research</option>
								
								<option data-help-url="/about/Router-BinFile-Analysis/" id="toc-Router-BinFile-Analysis">Router-BinFile-Analysis</option>
								
								<option data-help-url="/about/ALL-SQL-INJECTION-ANALYSIS/" id="toc-SQL注入原理分析">SQL注入原理分析</option>
								
								<option data-help-url="/about/ShiroDeser/" id="toc-ShiroDeser">ShiroDeser</option>
								
								<option data-help-url="/about/SpringBoot-Memory-files-heapdump-Analysis/" id="toc-SpringBoot-Memory-files-heapdump-Analysis">SpringBoot-Memory-files-heapdump-Analysis</option>
								
								<option data-help-url="/about/Struts2Deser/" id="toc-Struts2Deser">Struts2Deser</option>
								
								<option data-help-url="/about/javaDeser/" id="toc-javaDeser">javaDeser</option>
								
								<option data-help-url="/about/polkit-CVE-2021-3560/" id="toc-polkit-CVE-2021-3560">polkit-CVE-2021-3560</option>
								
								<option data-help-url="/about/Research-on-Webshell-Attack-of-Shiro-Framework-Based-on-Memory/" id="toc-基于内存的Shiro框架Webshell攻击研究">基于内存的Shiro框架Webshell攻击研究</option>
								
								<option data-help-url="/about/ALL-mvn-build-errors/" id="toc-安全与开发之：Maven构建排错">安全与开发之：Maven构建排错</option>
								
								<option data-help-url="/about/inspur-Cluster-Engine-V4.0-code-aduit-walkthrough/" id="toc-浪潮ClusterEngineV4.0代码审计历程">浪潮ClusterEngineV4.0代码审计历程</option>
								
								<option data-help-url="/about/ToDa-OA-VulnPoc-by-java-analysis/" id="toc-通达OA利用代码分析">通达OA利用代码分析</option>
								
							</select>
						</div>
					</form>
				</div>
				<div id="help-content">

				<center>
					
					<csmall>本文发布于：<em>2021-07-27</em>并最后修改于：<em>2021-09-03</em></csmall>
					
				<csmall><em> | 哨兵安全实验室</em></csmall>
				</center>

					<div class="hline"></div>
					<div class="spacing"></div>
<span class="post-print">
    <a href="javascript:window.print()"><ion-icon name="print-sharp" class="fa-2x"></ion-icon></a>
<!--click this icon -> scroll to top of page; code from anquanke. also this icon func are under-construction-->		
<!--<div class="back-to-top" onclick="$(&quot;html,body&quot;).animate({scrollTop:0}, 500);" style="position: fixed;bottom:400px;right: 20px;height: 40px;width: 40px;background-color: #1dada7;border-radius: 50%;text-align: center;cursor: pointer">
<img src="https://p0.ssl.qhimg.com/t0179ac3294ef926b8c.png" style="width:30px;margin-top: 6px;">
</div> -->
</span>
					<h1 id="零web">零：WEB</h1>

<h4 id="-0x01-任意文件读取绕过"># 0x01 任意文件读取绕过</h4>

<p>先看if判断主逻辑，同时满足下列三个条件即可：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">if (! empty($_REQUEST['file'])</code>
    <ul>
      <li>传入file参数不为空，不多说；</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">&amp;&amp; is_string($_REQUEST['file'])</code>
    <ul>
      <li>传入file参数是字符串；</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">&amp;&amp; emmm::checkFile($_REQUEST['file']))</code>
    <ul>
      <li>传入file参数满足<code class="language-plaintext highlighter-rouge">emmm类的checkFile函数</code>，主要看这个函数，传入checkFile函数的file参数被重新接受为page参数，判断参数是否为空、是否为字符串，是则往下：
        <ul>
          <li>1.检查$page在不在数组$whitelist里<code class="language-plaintext highlighter-rouge">$whitelist = ["source"=&gt;"source.php","hint"=&gt;"hint.php"]; if (in_array($page, $whitelist)) {return true;}</code>：
            <ul>
              <li>即：传入参数file<code class="language-plaintext highlighter-rouge">file=source(.php) / file=hint(.php)</code> ；</li>
            </ul>
          </li>
          <li>2.对传入参数进行一次url解码</li>
          <li>3.往下；
            <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nv">$_page</span> <span class="o">=</span> <span class="nb">mb_substr</span><span class="p">(</span>
  <span class="nv">$page</span><span class="p">,</span>
  <span class="mi">0</span><span class="p">,</span>
  <span class="nb">mb_strpos</span><span class="p">(</span><span class="nv">$page</span> <span class="mf">.</span> <span class="s1">'?'</span><span class="p">,</span> <span class="s1">'?'</span><span class="p">)</span>
  <span class="p">);</span>
</code></pre></div>            </div>
            <ul>
              <li>先看mb_strpos，就是？在$page里第一次出现的位置再看mb_substr，只留了$page从0到？的位置；</li>
            </ul>
          </li>
          <li>4.对<code class="language-plaintext highlighter-rouge">_page</code>重复1；</li>
          <li>5.对<code class="language-plaintext highlighter-rouge">_page</code>重复2；</li>
          <li>6.对<code class="language-plaintext highlighter-rouge">_page</code>重复3；</li>
          <li>7.再次判断参数重复1；</li>
          <li>8.<code class="language-plaintext highlighter-rouge">include $_REQUEST['file'];</code></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nb">highlight_file</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span>
<span class="kd">class</span> <span class="nc">emmm</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="n">checkFile</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$page</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$whitelist</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"source"</span><span class="o">=&gt;</span><span class="s2">"source.php"</span><span class="p">,</span><span class="s2">"hint"</span><span class="o">=&gt;</span><span class="s2">"hint.php"</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$page</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$page</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"you can't see it"</span><span class="p">;</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$page</span><span class="p">,</span> <span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$_page</span> <span class="o">=</span> <span class="nb">mb_substr</span><span class="p">(</span>
            <span class="nv">$page</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="nb">mb_strpos</span><span class="p">(</span><span class="nv">$page</span> <span class="mf">.</span> <span class="s1">'?'</span><span class="p">,</span> <span class="s1">'?'</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_page</span><span class="p">,</span> <span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$_page</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$page</span><span class="p">);</span>
        <span class="nv">$_page</span> <span class="o">=</span> <span class="nb">mb_substr</span><span class="p">(</span>
            <span class="nv">$_page</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="nb">mb_strpos</span><span class="p">(</span><span class="nv">$_page</span> <span class="mf">.</span> <span class="s1">'?'</span><span class="p">,</span> <span class="s1">'?'</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$_page</span><span class="p">,</span> <span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="s2">"you can't see it"</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nb">empty</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'file'</span><span class="p">])</span>
    <span class="o">&amp;&amp;</span> <span class="nb">is_string</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'file'</span><span class="p">])</span>
    <span class="o">&amp;&amp;</span> <span class="n">emmm</span><span class="o">::</span><span class="nf">checkFile</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'file'</span><span class="p">])</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="k">include</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'file'</span><span class="p">];</span>
    <span class="k">exit</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">"&lt;br&gt;&lt;img src=</span><span class="se">\"</span><span class="s2">https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>只要我们构造的参数满足上述步骤绕过：
<code class="language-plaintext highlighter-rouge">file=source.php%3f../../../../../../../../../../../../etc/passwd</code>，然后根据题目提示读取flag文件。</p>

<p><img src="https://i.loli.net/2021/07/29/XroGifUcBNMdsPz.png" alt="截屏2021-07-29 下午4.33.54.png" /></p>

<ul>
  <li>参考
    <ul>
      <li><a href="https://www.php.net/manual/zh/function.is-string.php" target="_blank">PHP: is_string - Manual</a></li>
      <li><a href="https://www.php.net/manual/zh/function.mb-strpos.php" target="_blank">PHP: mb_strpos - Manual</a></li>
      <li><a href="https://adworld.xctf.org.cn/task/writeup?type=web&amp;id=5442&amp;number=3&amp;grade=1&amp;page=undefined" target="_blank">XCTF - Warmup Writeup</a></li>
    </ul>
  </li>
</ul>

<h4 id="-0x02-nannannannan-batman奇妙的js"># 0x02 NaNNaNNaNNaN-Batman：奇妙的js</h4>

<p><a href="https://adworld.xctf.org.cn/media/task/attachments/646ecdf05af7490a85bb5c8ccb96c102.zip" target="_blank">NaNNaNNaNNaN-Batman附件</a>文本编辑器打开发现<code class="language-plaintext highlighter-rouge">&lt;script&gt;_='function $()</code>超文本标签，修改为html后缀，同时修改<code class="language-plaintext highlighter-rouge">eval(_)</code>为<code class="language-plaintext highlighter-rouge">alert(_)</code></p>

<p>处理后如下：</p>

<p><img src="https://i.loli.net/2021/07/29/nQH65odjRtgNeh9.png" alt="截屏2021-07-29 下午4.48.07.png" /></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">$</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">c</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="o">==</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^be0f23/</span><span class="p">)</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/233ac/</span><span class="p">)</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/e98aa$/</span><span class="p">)</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/c7be9/</span><span class="p">)</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="p">[</span><span class="dl">"</span><span class="s2">fl</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">s_a</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">i</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">e}</span><span class="dl">"</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">n</span><span class="o">=</span><span class="p">[</span><span class="dl">"</span><span class="s2">a</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">_h0l</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">n</span><span class="dl">"</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">r</span><span class="o">=</span><span class="p">[</span><span class="dl">"</span><span class="s2">g{</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">e</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">_0</span><span class="dl">"</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="p">[</span><span class="dl">"</span><span class="s2">it'</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">_</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">n</span><span class="dl">"</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">s</span><span class="o">=</span><span class="p">[</span><span class="nx">t</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">o</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">o</span><span class="o">&lt;</span><span class="mi">13</span><span class="p">;</span><span class="o">++</span><span class="nx">o</span><span class="p">){</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="nx">o</span><span class="o">%</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span><span class="nx">s</span><span class="p">[</span><span class="nx">o</span><span class="o">%</span><span class="mi">4</span><span class="p">].</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;input id="c"&gt;&lt;button onclick=$()&gt;Ok&lt;/button&gt;</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">delete</span> <span class="nx">_</span>
</code></pre></div></div>
<p>根据if判断逻辑内的定义console输出：</p>

<p><img src="https://i.loli.net/2021/07/29/vSJgTNcsjDFGMoz.png" alt="截屏2021-07-29 下午4.51.36.png" /></p>

<h4 id="-0x03-php伪协议"># 0x03 php伪协议</h4>

<p>本题思路：</p>

<ul>
  <li>index.php
    <ul>
      <li>对应file参数读取文件但是过滤了关键词<code class="language-plaintext highlighter-rouge">flag</code>，同时给出关键文件<code class="language-plaintext highlighter-rouge">secure.php</code></li>
      <li><code class="language-plaintext highlighter-rouge">secure.php</code>对应输出flag的逻辑；</li>
    </ul>
  </li>
  <li>secure.php
    <ul>
      <li>尝试读取对应php文件代码：</li>
      <li>读取payload<code class="language-plaintext highlighter-rouge">index.php?file=php://filter/read=convert.base64-encode/resource=secure.php</code></li>
    </ul>
  </li>
</ul>

<p><img src="https://i.loli.net/2021/07/30/Sxo6lWYBCIpQ2tU.png" alt="截屏2021-07-29 下午2.25.57.png" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">secure.php</code></li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜ <span class="nb">echo </span>PG1ldGEgY2hhcnNldD0iVVRGLTgiPgo8P3BocAogICAgaW5jbHVkZSAnLi9mbGFnLnBocCc7CiAgICBlcnJvcl9yZXBvcnRpbmcoMCk7CiAgICAkcGFyMSA9ICRfR0VUWydwYXIxJ107CiAgICAkcGFyMiA9ICRfR0VUWydwYXIyJ107CiAgICAkcGFyMyA9ICRfUE9TVFsncGFyMyddOwogICAgJHBhcjQgPSAkX1BPU1RbJ3BhcjQnXTsKICAgIGlmIChpc3NldCgkcGFyMSkmJmlzc2V0KCRwYXIyKSYmaXNzZXQoJHBhcjMpJiZpc3NldCgkcGFyNCkpIHsKICAgICAgICBpZiAoJHBhcjEgPT09ICRwYXIyICYmIG1kNSgkcGFyMSkgIT09IG1kNSgkcGFyMikpIHsKICAgICAgICAgICAgZGllKCfov5jmg7Por7vlj5ZmbGFn77yfJyk7CiAgICAgICAgfQogICAgICAgIGlmIChoYXNoKCJtZDQiLCAkcGFyMykgPT0gaGFzaCgibWQ0IiwgJHBhcjQpKSB7CiAgICAgICAgICAgIGVjaG8gJ+e7meS9oGZsYWfvvIEnIC4gJGZsYWc7CiAgICAgICAgfQogICAgfQo<span class="o">=</span>|base64 <span class="nt">-d</span>
<span class="c">#secure.php:</span>
&lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"UTF-8"</span><span class="o">&gt;</span>
&lt;?php
    include <span class="s1">'./flag.php'</span><span class="p">;</span>
    error_reporting<span class="o">(</span>0<span class="o">)</span><span class="p">;</span>
    <span class="nv">$par1</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="o">[</span><span class="s1">'par1'</span><span class="o">]</span><span class="p">;</span>
    <span class="nv">$par2</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="o">[</span><span class="s1">'par2'</span><span class="o">]</span><span class="p">;</span>
    <span class="nv">$par3</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="o">[</span><span class="s1">'par3'</span><span class="o">]</span><span class="p">;</span>
    <span class="nv">$par4</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="o">[</span><span class="s1">'par4'</span><span class="o">]</span><span class="p">;</span>
    <span class="k">if</span> <span class="o">(</span>isset<span class="o">(</span><span class="nv">$par1</span><span class="o">)&amp;&amp;</span>isset<span class="o">(</span><span class="nv">$par2</span><span class="o">)&amp;&amp;</span>isset<span class="o">(</span><span class="nv">$par3</span><span class="o">)&amp;&amp;</span>isset<span class="o">(</span><span class="nv">$par4</span><span class="o">))</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="nv">$par1</span> <span class="o">===</span> <span class="nv">$par2</span> <span class="o">&amp;&amp;</span> md5<span class="o">(</span><span class="nv">$par1</span><span class="o">)</span> <span class="o">!==</span> md5<span class="o">(</span><span class="nv">$par2</span><span class="o">))</span> <span class="o">{</span>
            die<span class="o">(</span><span class="s1">'还想读取flag？'</span><span class="o">)</span><span class="p">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="nb">hash</span><span class="o">(</span><span class="s2">"md4"</span>, <span class="nv">$par3</span><span class="o">)</span> <span class="o">==</span> <span class="nb">hash</span><span class="o">(</span><span class="s2">"md4"</span>, <span class="nv">$par4</span><span class="o">))</span> <span class="o">{</span>
            <span class="nb">echo</span> <span class="s1">'给你flag！'</span> <span class="nb">.</span> <span class="nv">$flag</span><span class="p">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>
<p>从代码可以看到直接传入的四个参数GET：<code class="language-plaintext highlighter-rouge">par1 &amp; par2</code>，POST：<code class="language-plaintext highlighter-rouge">par3 &amp; par4</code>；</p>

<p>判断：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">if (isset($par1)&amp;&amp;isset($par2)&amp;&amp;isset($par3)&amp;&amp;isset($par4))</code>
    <ul>
      <li>设置四个参数即可；</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">if ($par1 === $par2 &amp;&amp; md5($par1) !== md5($par2)) </code>
    <ul>
      <li>与判断，直接不满足其中一个条件即可；比如让两个参数不相等或两个参数的md5
  值不相等；</li>
    </ul>
  </li>
  <li>继续往下：<code class="language-plaintext highlighter-rouge">if (hash("md4", $par3) == hash("md4", $par4))</code>
    <ul>
      <li>两个参数的md4值相等给出flag；不多说，直接上payload：</li>
    </ul>
  </li>
</ul>

<p><img src="https://i.loli.net/2021/07/30/WgMqKXGUmrxoYIv.png" alt="" /></p>

<h4 id="-0x03-卖瓜"># 0x03 卖瓜</h4>

<p>这道题对于当下的我来说还是比较难，是看了题解才做得出来；究其原因我觉得是由于代码基础太过薄弱的缘故，就拿这道题来说，就算是找到<a href="https://www.php.net/manual/zh/language.types.integer.php">PHP文档: Integer 整型</a>，下一次遇到这样的题目还是没有办法。</p>

<p>题目描述：</p>

<div><p>有一个人前来买瓜。</p>
<p>HQ：哥们，这瓜多少钱一斤啊？</p>
<p>你：两块钱一斤。</p>
<p>HQ：What's up！这瓜皮子是金子做的还是瓜粒子是金子做的？</p>
<p>你：你瞧瞧现在哪有瓜啊？这都是大棚的瓜，只有 6 斤一个和 9 斤一个的，你嫌贵我还嫌贵呢。</p>
<p>（HQ 心里默默一算）</p>
<p>HQ：给我来 20 斤的瓜。</p>
<p>你：行！</p>
<p>HQ：行？这瓜能称出 20 斤吗？</p>
<p>你：我开水果摊的，还不会称重？</p>
<p>HQ：我问你这瓜能称出 20 斤吗？</p>
<p>你：你是故意找茬，是不是？你要不要吧！</p>
<p>HQ：你这瓜要是刚好 20 斤吗我肯定要啊。那它要是没有怎么办啊？</p>
<p>你：要是不是 20 斤，我自己吃了它，满意了吧？</p>
<p>（你开始选瓜称重）</p>
<p><b style="color:red">补充说明：当称的数字变为浮点数而不是整数时，HQ 不会认可最终的称重结果。</b></p></div>

<p>题目描述看完就可以得到方程： <code class="language-plaintext highlighter-rouge">6x + 9y = 20</code> ；我的第一反应是尝试能否负数来解题；而事实上并不可以:D</p>

<p><img src="" alt="img-No-negativenumbers" /></p>

<p>实际上，题目解题思路是没有问题的，我们可以看到上面标红的补充说明，因为我们知道上面的方程x和y是没有整数解的，所以基本思路就是通过Int型与Float型的数在PHP中的转换来使的正负相加得到一个固定的数，下面来谈谈这道题；</p>

<p>我们先来整理一下关键的点：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Server: nginx/1.21.3</code>、<code class="language-plaintext highlighter-rouge">X-Powered-By: PHP/8.0.10</code>；</li>
  <li><code class="language-plaintext highlighter-rouge">POST method: b6=1&amp;b9=1</code>，b6参数代表6斤的瓜，b9代表9斤的瓜；</li>
</ul>

<p>提出问题：</p>

<ul>
  <li>1、PHP8是否有这样的机制导致可以溢出为负整数呢？答：可以，<a href="https://www.php.net/manual/zh/language.types.integer.php">PHP文档: Integer 整型</a></li>
  <li>2、如果有的话，回到这道题上来，在没有给出代码的情况下如何利用呢？</li>
</ul>

<p>针对问题1，我参考文档给出的代码做了一些本地实验方便理解：</p>

<blockquote>
  <p>如果给定的一个数超出了 int 的范围，将会被解释为 float。同样如果执行的运算结果超出了 int 范围，也会返回 float。如下图：</p>
</blockquote>

<p><img src="https://i.loli.net/2021/11/04/6qzWEmMROCZ5TiS.png" alt="" /></p>

<blockquote>
  <p>当从浮点数 float 转换成整数 int 时，将向下取整。</p>
</blockquote>


				</div>
				<div class="spacing"></div>
	            <div>
	<div class="hline"></div>
	<h3><em>#</em> 申明</h3>
	<div class="spacing"></div>
	<h4><em>By: Bin4xin.</em></h4>
	<h4>转载请申明本文链接：<a href="/about/CTF-Code-Audit-WalkThrough/" target="_blank"><code-index-css><em>《Ctf Code Audit Walkthrough》</em></code-index-css></a></h4>

	<h3><em># Any Questions</em></h3>
	<div class="spacing"></div>
	<h4> >_ 对本文进行提问：<a href="https://github.com/sentryCyberSec/sentryCyberSec.github.io/issues/new?permalink=https://github.com/sentryCyberSec/sentryCyberSec.github.io/blob//about/CTF-Code-Audit-WalkThrough/index.html%23L84" target="_blank"> <em><li class="fa fa-github"></li> Reference in new issue.</em></a></h4>

	<h4> >_ 对本文进行留言：<a href="https://github.com/sentryCyberSec/sentryCyberSec.github.io/issues/new?permalink=《Ctf Code Audit Walkthrough》" target="_blank"> <em><li class="fa fa-github"></li> Leave a Comment.</em></a></h4>
	<div class="spacing"></div>
</div>
			</div><!-- about research name content -->
	  </div>
	</div><!--/container -->
</div><!--/about -->
<!-- </body> -->

<script src="/assets/js/sentryabout.js"></script>
<!-- </html> -->
<!--
vim: ts=2 sts=2 sw=2 noexpandtab
-->


        
<link rel="stylesheet" type="text/css" href="/assets/css/footer.css">
<div id="footerwrap" class="hidden-print">
    <div class="footer-container">
        <div class="pt3 pt3-ns pt3-m pt7-l pb0 pb0-ns pb0-m pb5-l">
            <div class="footer-row">
                <!--<div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f3 f3-ns f3-m f3-l">销售
                            <button class="dn dn-ns dn-m dn-l bn bg-transparent rotate-90">
                            <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="db db-ns db-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="blue2 f2 fw4" href="/plans/enterprise/contact/">企业级销售</a></li>
                            <li class="mt1 lh-6"><a class="blue2 f2 fw4" href="/partners/">成为合作伙伴</a></li>
                            <li class=""><span class="f2 fw4 blue2">联系销售：</span></li>
                            <li class=""><a class="f2 fw4 blue2" href="tel:+18889935273">+1 (888) 99 FLARE</a></li>
                        </ul>
                    </div>
                </div>-->
                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">入门
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/tuna/mirror-web" target="blank"><em>Jekyll Tuna</em>源码</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.github.io/blog/2019/jekyll/in/linux" target="blank">博客搭建教程</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.gitee.io/news/sentry-lab-markdown-usage/" target="blank">个性化语法批注</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.github.io/blog/2019/nginx/with/jekyll-site/" target="blank">公网部署</a></li>
                        </ul>
                    </div>
                </div>

                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">社区
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="/blog" target="blank">博客</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/bigger-than-bigger/tree/master/CoVV" target="blank"><em>Collection of verified vulnerabilities</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/bigger-than-bigger" target="blank"><em>Bigger than Bigger</em></a></li>
                        </ul>
                    </div>
                </div>

                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">开发
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/Bin4xin" target="blank"><em>Bin4xin</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://www.cloudflare.com/waf/" target="blank"><em>CloudFlare WAF</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://jekyllrb.com/docs/" target="blank"><em>Jekyll</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://www.markdownguide.org/" target="blank"><em>MarkDown</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/sentryCyberSec.github.io/actions" target="blank"><em>Github Action</em></a></li>
                        </ul>
                    </div>
                </div>

                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">关于
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://about.sentrylab.cn/" target="blank">近期研究</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4"><em> ∑ <csmall>(Visitors/times)</csmall></em></a></li>
                            <li class="mt1 lh-6">
                                <a class="white f2 fw4"><img src="https://profile-counter.glitch.me/sentryCyberSec.github.io/count.svg" style="max-width:100%;"></a>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">镜像
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/sentryCyberSec.github.io" target="blank">源码</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.gitee.io" target="blank">国内镜像/<em>CN MIRROR</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.github.io" target="blank">国外镜像/<em>OTHER MIRROR</em></a></li>
                        </ul>
                    </div>
                </div>
            </div><!-- "/row"-->
            <div class="pv5">
                <div class="flex flex-wrap justify-start justify-start-ns justify-start-m justify-between-l footer-bottom-row-margin">
                    <div class="mb3 mb3-ns mb3-m mb0-l lh-1 mt0 mt3-ns">
                        <a class="lh-1 dib mr2" title="Facebook" target="_blank" rel="noopener" href="https://www.facebook.com/#">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z" fill="white"></path>
                                <path d="M10.2965 16.7999H12.9405V27.6799C12.9405 27.786 12.9826 27.8877 13.0576 27.9628C13.1327 28.0378 13.2344 28.0799 13.3405 28.0799H17.8205C17.9266 28.0799 18.0283 28.0378 18.1033 27.9628C18.1783 27.8877 18.2205 27.786 18.2205 27.6799V16.8359H21.2605C21.3575 16.8369 21.4516 16.8025 21.5252 16.7392C21.5988 16.6759 21.6469 16.588 21.6605 16.4919L22.1205 12.4919C22.1255 12.4364 22.1189 12.3805 22.101 12.3278C22.0832 12.275 22.0545 12.2265 22.0169 12.1855C21.9792 12.1445 21.9334 12.1117 21.8824 12.0894C21.8313 12.0671 21.7762 12.0557 21.7205 12.0559H18.2005V9.53992C18.2005 8.78392 18.6005 8.39992 19.4005 8.39992H21.6925C21.7986 8.39992 21.9003 8.35778 21.9753 8.28276C22.0503 8.20775 22.0925 8.10601 22.0925 7.99992V4.31992C22.0925 4.21384 22.0503 4.11209 21.9753 4.03708C21.9003 3.96206 21.7986 3.91992 21.6925 3.91992H18.4005C16.9464 3.92501 15.5431 4.45481 14.4485 5.41192C13.9315 5.8638 13.5348 6.43694 13.294 7.07992C13.0531 7.7229 12.9756 8.41561 13.0685 9.09592V12.0319H10.2965C10.1904 12.0319 10.0887 12.0741 10.0136 12.1491C9.93863 12.2241 9.89648 12.3258 9.89648 12.4319V16.3999C9.89648 16.506 9.93863 16.6077 10.0136 16.6828C10.0887 16.7578 10.1904 16.7999 10.2965 16.7999Z" fill="#222222"></path>
                            </svg>
                        </a>
                        <a class="lh-1 dib mr2" title="Twitter" target="_blank" rel="noopener" href="https://twitter.com/bin4xin">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z" fill="white"></path>
                                <path d="M23.917 10.7759C23.6572 10.8922 23.3899 10.9911 23.117 11.0719C23.4414 10.7016 23.6865 10.2687 23.837 9.79988C23.8553 9.74704 23.8566 9.68979 23.8407 9.63616C23.8249 9.58253 23.7927 9.53519 23.7486 9.5008C23.7045 9.4664 23.6507 9.44666 23.5948 9.44435C23.539 9.44203 23.4838 9.45725 23.437 9.48788C22.867 9.82828 22.2476 10.0779 21.601 10.2279C21.0705 9.71367 20.3936 9.37678 19.6635 9.26372C18.9335 9.15065 18.1863 9.26699 17.5252 9.59667C16.8641 9.92635 16.3216 10.4531 15.9726 11.1043C15.6236 11.7554 15.4854 12.4988 15.577 13.2319C14.3655 13.1234 13.188 12.7738 12.1137 12.2037C11.0393 11.6335 10.0898 10.8543 9.32096 9.91188C9.29299 9.87906 9.25762 9.85336 9.21777 9.83689C9.17792 9.82043 9.13472 9.81368 9.09174 9.81719C9.04876 9.82071 9.00724 9.8344 8.97059 9.85712C8.93394 9.87984 8.90322 9.91095 8.88096 9.94788C8.56783 10.4919 8.40236 11.1082 8.40096 11.7359C8.39878 12.5818 8.69961 13.4006 9.24896 14.0439C9.0844 13.9873 8.92512 13.9163 8.77296 13.8319C8.73235 13.8102 8.68701 13.7988 8.64096 13.7988C8.59491 13.7988 8.54957 13.8102 8.50896 13.8319C8.46844 13.8548 8.43459 13.8879 8.41075 13.9279C8.3869 13.9678 8.37388 14.0133 8.37296 14.0599V14.1079C8.37409 14.7252 8.53538 15.3317 8.84107 15.8681C9.14676 16.4044 9.58638 16.8523 10.117 17.1679C10.0255 17.1604 9.93467 17.1471 9.84496 17.1279C9.79894 17.12 9.75169 17.124 9.70761 17.1394C9.66354 17.1548 9.62409 17.1811 9.59296 17.2159C9.56317 17.2506 9.54276 17.2923 9.53366 17.3371C9.52456 17.3819 9.52707 17.4283 9.54096 17.4719C9.72712 18.0654 10.0661 18.5996 10.5238 19.0209C10.9816 19.4421 11.542 19.7356 12.149 19.8719C11.1397 20.504 9.97183 20.8368 8.78096 20.8319C8.52009 20.8284 8.25965 20.8097 8.00096 20.7759C7.94069 20.7687 7.87975 20.7822 7.82814 20.8141C7.77652 20.846 7.73728 20.8946 7.71683 20.9517C7.69639 21.0089 7.69595 21.0713 7.71559 21.1287C7.73524 21.1862 7.7738 21.2352 7.82496 21.2679C9.37642 22.2633 11.1816 22.791 13.025 22.7879C14.3751 22.8191 15.7157 22.5538 16.9521 22.0106C18.1885 21.4673 19.2907 20.6594 20.181 19.6439C21.7606 17.848 22.6409 15.5435 22.661 13.1519C22.661 13.0559 22.661 12.9559 22.661 12.8599C23.2844 12.3901 23.8252 11.8196 24.261 11.1719C24.2928 11.1232 24.3081 11.0656 24.3048 11.0076C24.3015 10.9496 24.2797 10.8941 24.2426 10.8494C24.2054 10.8046 24.1549 10.773 24.0985 10.759C24.0421 10.7451 23.9826 10.7496 23.929 10.7719L23.917 10.7759Z" fill="#222222"></path>
                            </svg>
                        </a>
                        <a class="lh-1 dib mr2" title="LinkedIn" target="_blank" rel="noopener" href="https://www.linkedin.com/#">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z" fill="white"></path>
                                <path d="M17.0123 14.7596V14.7236L16.9883 14.7596H17.0123Z" fill="#222222"></path><path d="M11.3962 24.0561H7.79621V13.2001H11.3962V24.0561ZM9.60021 11.7001H9.57621C9.31915 11.7177 9.06122 11.6821 8.81857 11.5954C8.57591 11.5088 8.35376 11.3729 8.16602 11.1965C7.97828 11.02 7.82899 10.8067 7.7275 10.5698C7.62601 10.333 7.57451 10.0778 7.57621 9.82009C7.57621 8.75209 8.37621 7.94009 9.62021 7.94009C9.87894 7.92022 10.139 7.95412 10.384 8.03965C10.6289 8.12519 10.8536 8.26052 11.0437 8.43711C11.2338 8.61371 11.3853 8.82775 11.4887 9.06576C11.592 9.30378 11.645 9.56061 11.6442 9.82009C11.6362 10.8641 10.8522 11.7001 9.60021 11.7001ZM24.4322 24.0561H20.8002V18.2401C20.8002 16.7801 20.2802 15.7801 18.9722 15.7801C18.564 15.782 18.1664 15.9103 17.834 16.1474C17.5017 16.3845 17.2509 16.7187 17.1162 17.1041C17.0231 17.3877 16.9824 17.6859 16.9962 17.9841V24.0601H13.3962C13.3962 24.0601 13.4442 14.2041 13.3962 13.1841H16.9962V14.7241C17.3244 14.1561 17.8016 13.6886 18.3761 13.3721C18.9506 13.0556 19.6008 12.902 20.2562 12.9281C22.6322 12.9281 24.4162 14.4841 24.4162 17.8241L24.4322 24.0561Z" fill="#222222"></path>
                            </svg>
                        </a>
                        <a class="lh-1 dib mr2" title="Youtube" target="_blank" rel="noopener" href="https://www.youtube.com/channel/UClJ81qWUWtySnemTo7njueA">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z" fill="white"></path><path d="M24.0555 19.9478C23.964 20.3766 23.741 20.7662 23.4176 21.0623C23.0943 21.3584 22.6867 21.5463 22.2515 21.5998C20.1732 21.7893 18.086 21.8627 15.9995 21.8198C13.9131 21.8628 11.8258 21.7893 9.74752 21.5998C9.31377 21.5476 8.90704 21.3617 8.58377 21.0678C8.2605 20.7739 8.03674 20.3867 7.94352 19.9598C7.69907 18.6548 7.60113 17.3266 7.65152 15.9998C7.60334 14.6769 7.70262 13.3528 7.94752 12.0518C8.04104 11.6259 8.26439 11.2394 8.58677 10.9457C8.90915 10.6519 9.3147 10.4654 9.74752 10.4118C11.8256 10.2186 13.9128 10.1411 15.9995 10.1798C18.0873 10.1369 20.1759 10.2104 22.2555 10.3998C22.6889 10.4532 23.095 10.6396 23.4181 10.9333C23.7411 11.2269 23.9652 11.6135 24.0595 12.0398C24.3026 13.345 24.3992 14.6732 24.3475 15.9998C24.397 17.3226 24.2991 18.6468 24.0555 19.9478Z" fill="#222222"></path><path d="M13.8438 18.5923L19.1517 15.8403C17.3717 14.9123 15.5997 14.0003 13.8438 13.0723V18.5923Z" fill="white"></path>
                            </svg>
                        </a>
                    </div>

                    <div class="flex flex-wrap items-center fw5 lh-copy f1 mt0 mt3-ns footer-bottom-row-text-links-margin">
                        <span class="fw5 pr1 inline-flex">© 2019-2021 SentrySec, Lab. Build by Jekyll under the terms of the MIT License.</span>
                        <!-- <a class="bl inline-flex white lh-solid fw5 ph1" href="/privacypolicy/">隐私政策</a>
                        <a class="bl inline-flex white lh-solid fw5 ph1" href="/website-terms/">使用条款</a>
                        <a class="bl inline-flex white lh-solid fw5 ph1" href="/disclosure/">披露</a>
                        <a class="bl inline-flex white lh-solid fw5 ph1" href="/abuse/">信任与安全</a>
                        <button class="bl inline-flex white lh-solid fw5 ph1 bg-transparent outline-transparent pointer">Cookie 首选项</button>
                        <a class="bl inline-flex white lh-solid fw5 ph1" href="/trademark/">商标</a> -->
                    </div>
                </div>
            </div><!-- "/pv5" -->
        </div>
    </div>
</div><!--/footerwrap -->

    </body>
</html>